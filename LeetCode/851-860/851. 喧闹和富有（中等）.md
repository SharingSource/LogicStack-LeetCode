### é¢˜ç›®æè¿°

è¿™æ˜¯ LeetCode ä¸Šçš„ **[851. å–§é—¹å’Œå¯Œæœ‰](https://leetcode-cn.com/problems/loud-and-rich/solution/gong-shui-san-xie-tuo-bu-pai-xu-yun-yong-ylih/)** ï¼Œéš¾åº¦ä¸º **ä¸­ç­‰**ã€‚

Tag : ã€Œæ‹“æ‰‘æ’åºã€



æœ‰ä¸€ç»„ `n` ä¸ªäººä½œä¸ºå®éªŒå¯¹è±¡ï¼Œä» `0` åˆ° `n - 1` ç¼–å·ï¼Œå…¶ä¸­æ¯ä¸ªäººéƒ½æœ‰ä¸åŒæ•°ç›®çš„é’±ï¼Œä»¥åŠä¸åŒç¨‹åº¦çš„å®‰é™å€¼ï¼ˆ`quietness`ï¼‰ã€‚ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬å°†ç¼–å·ä¸ºÂ `x`Â çš„äººç®€ç§°ä¸º `"personÂ x"`ã€‚

ç»™ä½ ä¸€ä¸ªæ•°ç»„ `richer` ï¼Œå…¶ä¸­ `richer[i] = [ai, bi]` è¡¨ç¤º $person$Â $a_i$Â æ¯” $person$Â $b_i$Â æ›´æœ‰é’±ã€‚å¦ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `quiet`ï¼Œå…¶ä¸­Â `quiet[i]` æ˜¯ $person_i$ çš„å®‰é™å€¼ã€‚

`richer` ä¸­æ‰€ç»™å‡ºçš„æ•°æ® é€»è¾‘è‡ªæ°ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ $person_x$ æ¯” $person_y$ æ›´æœ‰é’±çš„åŒæ—¶ï¼Œä¸ä¼šå‡ºç° $person_y$ æ¯” $person_x$ æ›´æœ‰é’±çš„æƒ…å†µ ï¼‰ã€‚

ç°åœ¨ï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°æ•°ç»„ `answer` ä½œä¸ºç­”æ¡ˆï¼Œå…¶ä¸­Â `answer[x] = y`Â çš„å‰ææ˜¯ï¼Œåœ¨æ‰€æœ‰æ‹¥æœ‰çš„é’±è‚¯å®šä¸å°‘äºÂ `personÂ x`Â çš„äººä¸­ï¼Œ`personÂ y`Â æ˜¯æœ€å®‰é™çš„äººï¼ˆä¹Ÿå°±æ˜¯å®‰é™å€¼Â `quiet[y]`Â æœ€å°çš„äººï¼‰ã€‚

ç¤ºä¾‹ 1ï¼š
```
è¾“å…¥ï¼šricher = [[1,0],[2,1],[3,1],[3,7],[4,3],[5,3],[6,3]], quiet = [3,2,5,4,6,1,7,0]

è¾“å‡ºï¼š[5,5,2,5,4,5,6,7]

è§£é‡Šï¼š 
answer[0] = 5ï¼Œ
person 5 æ¯” person 3 æœ‰æ›´å¤šçš„é’±ï¼Œperson 3 æ¯” person 1 æœ‰æ›´å¤šçš„é’±ï¼Œperson 1 æ¯” person 0 æœ‰æ›´å¤šçš„é’±ã€‚
å”¯ä¸€è¾ƒä¸ºå®‰é™ï¼ˆæœ‰è¾ƒä½çš„å®‰é™å€¼ quiet[x]ï¼‰çš„äººæ˜¯ person 7ï¼Œ
ä½†æ˜¯ç›®å‰è¿˜ä¸æ¸…æ¥šä»–æ˜¯å¦æ¯” person 0 æ›´æœ‰é’±ã€‚
answer[7] = 7ï¼Œ
åœ¨æ‰€æœ‰æ‹¥æœ‰çš„é’±è‚¯å®šä¸å°‘äº person 7 çš„äººä¸­ï¼ˆè¿™å¯èƒ½åŒ…æ‹¬ person 3ï¼Œ4ï¼Œ5ï¼Œ6 ä»¥åŠ 7ï¼‰ï¼Œ
æœ€å®‰é™ï¼ˆæœ‰è¾ƒä½å®‰é™å€¼ quiet[x]ï¼‰çš„äººæ˜¯ person 7ã€‚
å…¶ä»–çš„ç­”æ¡ˆä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„æ¨ç†æ¥è§£é‡Šã€‚
```
ç¤ºä¾‹ 2ï¼š
```
è¾“å…¥ï¼šricher = [], quiet = [0]

è¾“å‡ºï¼š[0]
```

æç¤ºï¼š
* $n == quiet.length$
* $1 <= n <= 500$
* $0 <= quiet[i] < n$
* $quiet$ çš„æ‰€æœ‰å€¼ äº’ä¸ç›¸åŒ
* $0 <= richer.length <= n * (n - 1) / 2$
* $0 <= ai, bi < n$
* $ai != bi$
* `richer` ä¸­çš„æ‰€æœ‰æ•°å¯¹ äº’ä¸ç›¸åŒ
* å¯¹ `richer` çš„è§‚å¯Ÿåœ¨é€»è¾‘ä¸Šæ˜¯ä¸€è‡´çš„

---

### æ‹“æ‰‘æ’åº

æ ¹æ®é¢˜æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `richer` è¿›è¡Œå»ºå›¾ï¼ˆé‚»æ¥çŸ©é˜µ/é‚»æ¥è¡¨ï¼‰ï¼Œå¯¹äºæ¯ç»„ $richer[i] = (a_i, b_i)$ è€Œè¨€ï¼Œæ·»åŠ ä¸€æ¡ä» $a$ åˆ° $b$ çš„æœ‰å‘è¾¹ï¼ˆæœ‰é’±æŒ‡å‘æ²¡é’±ï¼‰ã€‚

å…¶ä¸­é¢˜ç›®ä¸­çš„ã€Œ`richer` é€»è¾‘è‡ªæ°ã€æ˜¯æŒ‡åœ¨è¯¥å›¾ä¸­ä¸å­˜åœ¨ç¯ï¼Œå³ä¸º DAGã€‚

å› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨å»ºå›¾è¿‡ç¨‹ä¸­ï¼ŒåŒæ—¶ç»Ÿè®¡æ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦æ•°ï¼Œç„¶ååœ¨å›¾ä¸­è·‘ä¸€éæ‹“æ‰‘æ’åºæ¥æ±‚å¾—ç­”æ¡ˆ $ans$ã€‚

**å¯¹ã€Œå›¾è®º æ‹“æ‰‘æ’åºã€ä¸äº†è§£çš„åŒå­¦ï¼Œå¯ä»¥å…ˆçœ‹å‰ç½® ğŸ§€ï¼š[æ‹“æ‰‘æ’åºå…¥é—¨](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247489706&idx=1&sn=771cd807f39d1ca545640c0ef7e5baec&chksm=fd9cb3b5caeb3aa333809633f09e3967c8f62d10feec5a463c7e30d4781e1fecb50e7f46e4af&token=126965152&lang=zh_CN#rd)ï¼Œé‡Œé¢è¯¦ç»†è¯´æ˜äº†ã€Œæ‹“æ‰‘æ’åºçš„åŸºæœ¬æµç¨‹ã€&ã€Œåå‘å›¾ + æ‹“æ‰‘æ’åºåšæ³•çš„æ­£ç¡®æ€§è¯æ˜ã€ã€‚**

èµ·å§‹æ—¶ï¼Œæ¯ä¸ª $ans[i] = i$ï¼Œç„¶åå°†ç»Ÿè®¡å…¥åº¦ä¸º $0$ çš„èŠ‚ç‚¹è¿›è¡Œå…¥é˜Ÿï¼Œæ¯æ¬¡å‡ºé˜Ÿæ—¶ï¼Œå°†è¯¥èŠ‚ç‚¹åˆ æ‰ï¼Œå¯¹è¯¥ DAG å¸¦æ¥å½±å“æ˜¯ã€Œè¯¥èŠ‚ç‚¹çš„é‚»ç‚¹çš„å…¥åº¦å‡ä¸€ã€ï¼Œè‹¥æ›´æ–°å…¥åº¦åæ•°å€¼ä¸º $0$ï¼Œåˆ™å°†è¯¥é‚»ç‚¹è¿›è¡Œå…¥é˜Ÿæ“ä½œã€‚

åŒæ—¶ï¼Œåˆ©ç”¨è·‘æ‹“æ‰‘æ’åºè¿‡ç¨‹ä¸­çš„ $t -> u$ å…³ç³»ï¼Œå°è¯•ä½¿ç”¨ $ans[t]$ æ›´æ–° $ans[u]$ï¼ˆç”±äºå­˜åœ¨ $t$ æŒ‡å‘ $u$ çš„è¾¹ï¼Œè¯´æ˜ $t$ æ¯” $u$ æœ‰é’±ï¼Œæ­¤æ—¶æ£€æŸ¥ä¸¤è€…çš„å®‰é™å€¼ï¼Œè‹¥æ»¡è¶³ $quiet[ans[t]] < quiet[ans[u]]$ï¼Œåˆ™ç”¨ $ans[t]$ æ›´æ–° $ans[u]$ï¼‰ã€‚

> æœ¬é¢˜ä¸ºç¨ å¯†å›¾ï¼ˆç‚¹æ•°ä¸º $n$ï¼Œè¾¹æ•°ä¸º $m$ï¼Œå½“ $m$ ä¸ $n^2$ ä¸ºåŒä¸€æ•°æ®çº§ï¼Œå®šä¹‰ä»¥ä¸ºç¨ å¯†å›¾ï¼‰ï¼Œå¯ç›´æ¥ä½¿ç”¨ã€Œé‚»æ¥çŸ©é˜µã€è¿›è¡Œå­˜å›¾ã€‚
å…³äºä½•ç§å›¾é€‰æ‹©ä»€ä¹ˆå­˜å›¾æ–¹å¼ï¼Œåœ¨ [è¿™é‡Œ](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247488007&idx=1&sn=9d0dcfdf475168d26a5a4bd6fcd3505d&chksm=fd9cb918caeb300e1c8844583db5c5318a89e60d8d552747ff8c2256910d32acd9013c93058f&token=126965152&lang=zh_CN#rd) è¯¦ç»†è®²è¿‡ï¼Œæœ¬æ¬¡ä¸å†èµ˜è¿°ã€‚

ä»£ç ï¼ˆ$P1$ ä¸ºé‚»æ¥çŸ©é˜µï¼Œ$P2$ ä¸ºé‚»æ¥è¡¨ï¼‰ï¼š
```Java
class Solution {
    public int[] loudAndRich(int[][] richer, int[] quiet) {
        int n = quiet.length;
        int[][] w = new int[n][n];
        int[] in = new int[n];
        for (int[] r : richer) {
            int a = r[0], b = r[1];
            w[a][b] = 1; in[b]++;
        }
        Deque<Integer> d = new ArrayDeque<>();
        int[] ans = new int[n];
        for (int i = 0; i < n; i++) {
            ans[i] = i;
            if (in[i] == 0) d.addLast(i);
        }
        while (!d.isEmpty()) {
            int t = d.pollFirst();
            for (int u = 0; u < n; u++) {
                if (w[t][u] == 1) {
                    if (quiet[ans[t]] < quiet[ans[u]]) ans[u] = ans[t];
                    if (--in[u] == 0) d.addLast(u);
                }
            }
        }
        return ans;
    }
}
```


```Java
class Solution {
    int N = 510, M = N * N + 10;
    int[] he = new int[N], e = new int[M], ne = new int[M];
    int idx;
    void add(int a, int b) {
        e[idx] = b;
        ne[idx] = he[a];
        he[a] = idx;
        idx++;
    }
    public int[] loudAndRich(int[][] richer, int[] quiet) {
        int n = quiet.length;
        int[] in = new int[n];
        Arrays.fill(he, -1);
        for (int[] r : richer) {
            int a = r[0], b = r[1];
            add(a, b); in[b]++;
        }
        Deque<Integer> d = new ArrayDeque<>();
        int[] ans = new int[n];
        for (int i = 0; i < n; i++) {
            ans[i] = i;
            if (in[i] == 0) d.addLast(i);
        }
        while (!d.isEmpty()) {
            int t = d.pollFirst();
            for (int i = he[t]; i != -1; i = ne[i]) {
                int u = e[i];
                if (quiet[ans[t]] < quiet[ans[u]]) ans[u] = ans[t];
                if (--in[u] == 0) d.addLast(u);
            }
        }
        return ans;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šä»¤ $n$ ä¸º `person` æ•°é‡ï¼ˆç‚¹æ•°ï¼‰ï¼Œ$m$ ä¸º `richer` é•¿åº¦ï¼ˆè¾¹æ•°ï¼‰ã€‚çš„å»ºå›¾çš„å¤æ‚åº¦ä¸º $O(m)$ï¼›æ‹“æ‰‘æ’åºå¤æ‚åº¦ä¸º $O(m + n)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(m + n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(m + n)$

---

### æœ€å

è¿™æ˜¯æˆ‘ä»¬ã€Œåˆ·ç©¿ LeetCodeã€ç³»åˆ—æ–‡ç« çš„ç¬¬ `No.851` ç¯‡ï¼Œç³»åˆ—å¼€å§‹äº 2021/01/01ï¼Œæˆªæ­¢äºèµ·å§‹æ—¥ LeetCode ä¸Šå…±æœ‰ 1916 é“é¢˜ç›®ï¼Œéƒ¨åˆ†æ˜¯æœ‰é”é¢˜ï¼Œæˆ‘ä»¬å°†å…ˆæŠŠæ‰€æœ‰ä¸å¸¦é”çš„é¢˜ç›®åˆ·å®Œã€‚

åœ¨è¿™ä¸ªç³»åˆ—æ–‡ç« é‡Œé¢ï¼Œé™¤äº†è®²è§£è§£é¢˜æ€è·¯ä»¥å¤–ï¼Œè¿˜ä¼šå°½å¯èƒ½ç»™å‡ºæœ€ä¸ºç®€æ´çš„ä»£ç ã€‚å¦‚æœæ¶‰åŠé€šè§£è¿˜ä¼šç›¸åº”çš„ä»£ç æ¨¡æ¿ã€‚

ä¸ºäº†æ–¹ä¾¿å„ä½åŒå­¦èƒ½å¤Ÿç”µè„‘ä¸Šè¿›è¡Œè°ƒè¯•å’Œæäº¤ä»£ç ï¼Œæˆ‘å»ºç«‹äº†ç›¸å…³çš„ä»“åº“ï¼šhttps://github.com/SharingSource/LogicStack-LeetCode ã€‚

åœ¨ä»“åº“åœ°å€é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°ç³»åˆ—æ–‡ç« çš„é¢˜è§£é“¾æ¥ã€ç³»åˆ—æ–‡ç« çš„ç›¸åº”ä»£ç ã€LeetCode åŸé¢˜é“¾æ¥å’Œå…¶ä»–ä¼˜é€‰é¢˜è§£ã€‚

