### é¢˜ç›®æè¿°

è¿™æ˜¯ LeetCode ä¸Šçš„ **[646. æœ€é•¿æ•°å¯¹é“¾](https://leetcode.cn/problems/maximum-length-of-pair-chain/solution/by-ac_oier-z91l/)** ï¼Œéš¾åº¦ä¸º **ä¸­ç­‰**ã€‚

Tag : ã€Œè´ªå¿ƒã€ã€ã€Œæ’åºã€ã€ã€ŒäºŒåˆ†ã€ã€ã€Œåºåˆ— DPã€ã€ã€ŒLISã€



ç»™å‡ºÂ `n`Â ä¸ªæ•°å¯¹ã€‚

åœ¨æ¯ä¸€ä¸ªæ•°å¯¹ä¸­ï¼Œç¬¬ä¸€ä¸ªæ•°å­—æ€»æ˜¯æ¯”ç¬¬äºŒä¸ªæ•°å­—å°ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ç§è·Ÿéšå…³ç³»ï¼Œå½“ä¸”ä»…å½“Â `b < c`Â æ—¶ï¼Œæ•°å¯¹ $(c, d)$Â æ‰å¯ä»¥è·Ÿåœ¨Â $(a, b)$Â åé¢ã€‚æˆ‘ä»¬ç”¨è¿™ç§å½¢å¼æ¥æ„é€ ä¸€ä¸ªæ•°å¯¹é“¾ã€‚

ç»™å®šä¸€ä¸ªæ•°å¯¹é›†åˆï¼Œæ‰¾å‡ºèƒ½å¤Ÿå½¢æˆçš„æœ€é•¿æ•°å¯¹é“¾çš„é•¿åº¦ã€‚ä½ ä¸éœ€è¦ç”¨åˆ°æ‰€æœ‰çš„æ•°å¯¹ï¼Œä½ å¯ä»¥ä»¥ä»»ä½•é¡ºåºé€‰æ‹©å…¶ä¸­çš„ä¸€äº›æ•°å¯¹æ¥æ„é€ ã€‚

ç¤ºä¾‹ï¼š
```
è¾“å…¥ï¼š[[1,2], [2,3], [3,4]]

è¾“å‡ºï¼š2

è§£é‡Šï¼šæœ€é•¿çš„æ•°å¯¹é“¾æ˜¯ [1,2] -> [3,4]
```

æç¤ºï¼š
* ç»™å‡ºæ•°å¯¹çš„ä¸ªæ•°åœ¨Â $[1, 1000]$ èŒƒå›´å†…ã€‚

---

### æ’åº + è´ªå¿ƒ DP

èµ·å§‹å…ˆå°† `pairs` æ ¹æ®ç¬¬ä¸€ç»´æ’å‡åºï¼ˆæˆ–ç›´æ¥åŒå…³é”®å­—æ’å‡åºï¼‰ã€‚

è€ƒè™‘å®šä¹‰ $f[i]$ ä¸ºä»¥ $pairs[i]$ ä¸ºç»“å°¾çš„æœ€é•¿æ•°å¯¹é“¾é•¿åº¦ï¼Œæ‰€æœ‰ $f[i]$ ä¸­çš„æœ€å¤§å€¼ä¸ºç­”æ¡ˆã€‚

ä¸å¤±ä¸€èˆ¬æ€§è€ƒè™‘ $f[i]$ è¯¥å¦‚ä½•è½¬ç§»ï¼šä¸éš¾å‘ç° $f[i]$ ä¸ºæ‰€æœ‰æ»¡è¶³ã€Œä¸‹æ ‡èŒƒå›´åœ¨ $[0, i - 1]$ï¼Œä¸” $pairs[j][1] < pairs[i][0]$ã€æ¡ä»¶çš„ $f[j] + 1$ çš„æœ€å¤§å€¼ã€‚

ä½†å®é™…ä¸Šï¼Œæˆ‘ä»¬åªéœ€è¦ä» $j = i - 1$ å¼€å§‹å¾€å›æ‰¾ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³ $pairs[j][1] < pairs[i][0]$ çš„ä½ç½® $j$ å³å¯ã€‚

å®¹æ˜“è¯æ˜è¯¥åšæ³•çš„æ­£ç¡®æ€§ï¼š**å‡è®¾è´ªå¿ƒè§£ï¼ˆè¯¥åšæ³•ï¼‰æ‰¾åˆ°çš„ä½ç½® $j$ ä¸æ˜¯æœ€ä¼˜ä½ç½®ï¼Œå³å­˜åœ¨æ¯” $j$ æ›´å°çš„åˆæ³•ä¸‹æ ‡ $j'$ æ»¡è¶³ $f[j'] > f[j]$ã€‚æ ¹æ®æˆ‘ä»¬çš„æ’åºè§„åˆ™å¿…ç„¶æœ‰ $pairs[j'][0] <= pairs[j][0]$ çš„æ€§è´¨ï¼Œåˆ™å¯çŸ¥ $pairs[j]$ å¿…ç„¶å¯ä»¥ä»£æ›¿ $pairs[j']$ æ¥åœ¨åŸæœ¬ä»¥ $pairs[j']$ ä¸ºç»“å°¾çš„æœ€ä¼˜æ•°é“¾ä¸Šï¼ˆæœ€ä¼˜æ•°é“¾é•¿åº¦ä¸å˜ï¼Œç»“æœä¸ä¼šå˜å·®ï¼‰ï¼Œåˆ™è‡³å°‘æœ‰ $f[j'] = f[j]$ã€‚**

Java ä»£ç ï¼š
```Java
class Solution {
    public int findLongestChain(int[][] pairs) {
        Arrays.sort(pairs, (a,b)->a[0]-b[0]);
        int n = pairs.length, ans = 1;
        int[] f = new int[n];
        for (int i = 0; i < n; i++) {
            f[i] = 1;
            for (int j = i - 1; j >= 0 && f[i] == 1; j--) {
                if (pairs[j][1] < pairs[i][0]) f[i] = f[j] + 1;
            }
            ans = Math.max(ans, f[i]);
        }
        return ans;
    }
}
```
C++ ä»£ç ï¼š
```C++
class Solution {
public:
    int findLongestChain(vector<vector<int>>& pairs) {
        sort(pairs.begin(), pairs.end());
        int n = pairs.size(), ans = 1;
        vector<int> f(n, 1);
        for (int i = 0; i < n; i++) {
            f[i] = 1;
            for (int j = i - 1; j >= 0 && f[i] == 1; j--) {
                if (pairs[j][1] < pairs[i][0]) f[i] = f[j] + 1;
            }
            ans = max(ans, f[i]);
        }
        return ans;
    }
};
```
Python ä»£ç ï¼š
```Python
class Solution:
    def findLongestChain(self, pairs: List[List[int]]) -> int:
        pairs.sort()
        n, ans = len(pairs), 1
        f = [1] * n
        for i in range(n):
            j = i - 1
            while j >= 0 and f[i] == 1:
                if pairs[j][1] < pairs[i][0]:
                    f[i] = f[j] + 1
                j -= 1
            ans = max(ans, f[i])
        return ans
```
TypeScript ä»£ç ï¼š
```TypeScript
function findLongestChain(pairs: number[][]): number {
    pairs.sort((a, b) => a[0] - b[0]);
    let n = pairs.length, ans = 1;
    const f: number[] = new Array(n).fill(1);    
    for (let i = 0; i < n; i++) {
        f[i] = 1;
        for (let j = i - 1; j >= 0 && f[i] == 1; j--) {
            if (pairs[j][1] < pairs[i][0]) f[i] = f[j] + 1;
        }
        ans = Math.max(ans, f[i]);
    }
    return ans;
};
```
* æ—¶é—´å¤æ‚åº¦ï¼šæ’åºçš„å¤æ‚åº¦ä¸º $O(n\log{n})$ï¼›ä¸è€ƒè™‘å‰ªææ•ˆæœ `DP` å¤æ‚åº¦ä¸º $O(n^2)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(n^2)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

### æ’åº + è´ªå¿ƒ DPï¼ˆä¼˜åŒ–è½¬ç§»ï¼‰

æ ¹æ®ä¸Šè¿°åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“å¯¹äºä¸€ä¸ªç‰¹å®šçš„ $pairs[i]$ è€Œè¨€ï¼Œå…¶æ‰€æœ‰åˆæ³•ï¼ˆæ»¡è¶³æ¡ä»¶ $pairs[j][1] < pairs[i][0]$ï¼‰çš„å‰é©±çŠ¶æ€ $f[j]$ å¿…ç„¶æ˜¯éå•è°ƒé€’å¢çš„ã€‚

æ ¹æ® `LIS` é—®é¢˜çš„è´ªå¿ƒè§£çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥é¢å¤–ä½¿ç”¨ä¸€ä¸ªæ•°ç»„è®°å½•ä¸‹ç‰¹å®šé•¿åº¦æ•°é“¾çš„æœ€å°ç»“å°¾å€¼ï¼Œä»è€Œå®ç°äºŒåˆ†æ‰¾å‰é©±çŠ¶æ€ã€‚

å…·ä½“çš„ï¼Œåˆ›å»º $g$ æ•°ç»„ï¼Œå…¶ä¸­ $g[len] = x$ ä»£è¡¨æ•°é“¾é•¿åº¦ä¸º $len$ æ—¶ç»“å°¾å…ƒç´ çš„ç¬¬äºŒç»´æœ€å°å€¼ä¸º $x$ã€‚

å¦‚æ­¤ä¸€æ¥ï¼Œå½“æˆ‘ä»¬è¦æ‰¾ $f[i]$ çš„å‰é©±çŠ¶æ€æ—¶ï¼Œç­‰ä»·äºåœ¨ $g$ æ•°ç»„ä¸­æ‰¾æ»¡è¶³ã€Œå°äº $pairs[i][0]$ã€çš„æœ€å¤§ä¸‹æ ‡ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦æ˜¾å¼ç»´æŠ¤ $f$ æ•°ç»„ï¼Œåªéœ€è¦è¾¹è½¬ç§»å˜æ›´æ–°ç­”æ¡ˆå³å¯ã€‚

> **ä¸äº†è§£ `LIS` é—®é¢˜çš„åŒå­¦å¯ä»¥çœ‹å‰ç½® ğŸ§€ : [LCS é—®é¢˜ä¸ LIS é—®é¢˜çš„ç›¸äº’å…³ç³»ï¼Œä»¥åŠ LIS é—®é¢˜çš„æœ€ä¼˜è§£è¯æ˜](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247505761&idx=1&sn=a84744d9670c3276e41ccea043dc798d&chksm=fd9f7c7ecae8f568e2c4203dcccacabe880fa3ccd09dcd050dfcc0cc98c1ccc9ebcf39babded#rd) ğŸ‰ğŸ‰ğŸ‰**

Java ä»£ç ï¼š
```Java
class Solution {
    public int findLongestChain(int[][] pairs) {
        Arrays.sort(pairs, (a,b)->a[0]-b[0]);
        int n = pairs.length, ans = 1;
        int[] g = new int[n + 10];
        Arrays.fill(g, 0x3f3f3f3f);
        for (int i = 0; i < n; i++) {
            int l = 1, r = i + 1;
            while (l < r) {
                int mid = l + r >> 1;
                if (g[mid] >= pairs[i][0]) r = mid;
                else l = mid + 1;
            }
            g[r] = Math.min(g[r], pairs[i][1]);
            ans = Math.max(ans, r);
        }
        return ans;
    }
}
```
C++ ä»£ç ï¼š
```C++
class Solution {
public:
    int findLongestChain(vector<vector<int>>& pairs) {
        sort(pairs.begin(), pairs.end());
        int n = pairs.size(), ans = 1;
        vector<int> g(n + 10, 0x3f3f3f3f);
        for (int i = 0; i < n; i++) {
            int l = 1, r = i + 1;
            while (l < r) {
                int mid = l + r >> 1;
                if (g[mid] >= pairs[i][0]) r = mid;
                else l = mid + 1;
            }
            g[r] = min(g[r], pairs[i][1]);
            ans = max(ans, r);
        }
        return ans;
    }
};
```
Python ä»£ç ï¼š
```Python
class Solution:
    def findLongestChain(self, pairs: List[List[int]]) -> int:
        pairs.sort()
        n, ans = len(pairs), 1
        g = [0x3f3f3f3f] * (n + 10)
        for i in range(n):
            l, r = 1, i + 1
            while l < r:
                mid = l + r >> 1
                if g[mid] >= pairs[i][0]:
                    r = mid
                else:
                    l = mid + 1
            g[r] = min(g[r], pairs[i][1])
            ans = max(ans, r)
        return ans
```
TypeScript ä»£ç ï¼š
```TypeScript
function findLongestChain(pairs: number[][]): number {
    pairs.sort((a, b) => a[0] - b[0]);
    let n = pairs.length, ans = 1;
    const g: number[] = new Array(n + 10).fill(0x3f3f3f3f);
    for (let i = 0; i < n; i++) {
        let l = 1, r = i + 1;
        while (l < r) {
            const mid = l + r >> 1;
            if (g[mid] >= pairs[i][0]) r = mid;    
            else l = mid + 1; 
        }
        g[r] = Math.min(g[r], pairs[i][1]);
        ans = Math.max(ans, r);
    }
    return ans;
};
```
* æ—¶é—´å¤æ‚åº¦ï¼šæ’åºçš„å¤æ‚åº¦ä¸º $O(n\log{n})$ï¼›`DP` å¤æ‚åº¦ä¸º $O(n\log{n})$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(n\log{n})$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

### æœ€å

è¿™æ˜¯æˆ‘ä»¬ã€Œåˆ·ç©¿ LeetCodeã€ç³»åˆ—æ–‡ç« çš„ç¬¬ `No.646` ç¯‡ï¼Œç³»åˆ—å¼€å§‹äº 2021/01/01ï¼Œæˆªæ­¢äºèµ·å§‹æ—¥ LeetCode ä¸Šå…±æœ‰ 1916 é“é¢˜ç›®ï¼Œéƒ¨åˆ†æ˜¯æœ‰é”é¢˜ï¼Œæˆ‘ä»¬å°†å…ˆæŠŠæ‰€æœ‰ä¸å¸¦é”çš„é¢˜ç›®åˆ·å®Œã€‚

åœ¨è¿™ä¸ªç³»åˆ—æ–‡ç« é‡Œé¢ï¼Œé™¤äº†è®²è§£è§£é¢˜æ€è·¯ä»¥å¤–ï¼Œè¿˜ä¼šå°½å¯èƒ½ç»™å‡ºæœ€ä¸ºç®€æ´çš„ä»£ç ã€‚å¦‚æœæ¶‰åŠé€šè§£è¿˜ä¼šç›¸åº”çš„ä»£ç æ¨¡æ¿ã€‚

ä¸ºäº†æ–¹ä¾¿å„ä½åŒå­¦èƒ½å¤Ÿç”µè„‘ä¸Šè¿›è¡Œè°ƒè¯•å’Œæäº¤ä»£ç ï¼Œæˆ‘å»ºç«‹äº†ç›¸å…³çš„ä»“åº“ï¼šhttps://github.com/SharingSource/LogicStack-LeetCode ã€‚

åœ¨ä»“åº“åœ°å€é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°ç³»åˆ—æ–‡ç« çš„é¢˜è§£é“¾æ¥ã€ç³»åˆ—æ–‡ç« çš„ç›¸åº”ä»£ç ã€LeetCode åŸé¢˜é“¾æ¥å’Œå…¶ä»–ä¼˜é€‰é¢˜è§£ã€‚

