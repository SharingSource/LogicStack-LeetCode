### é¢˜ç›®æè¿°

è¿™æ˜¯ LeetCode ä¸Šçš„ **[954. äºŒå€æ•°å¯¹æ•°ç»„](https://leetcode-cn.com/problems/array-of-doubled-pairs/solution/by-ac_oier-d1z7/)** ï¼Œéš¾åº¦ä¸º **ä¸­ç­‰**ã€‚

Tag : ã€Œä¼˜å…ˆé˜Ÿåˆ—ã€ã€ã€Œå †ã€ã€ã€Œæ„é€ ã€ã€ã€Œå“ˆå¸Œè¡¨ã€ã€ã€Œæ‹“æ‰‘æ’åºã€



ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºå¶æ•°çš„æ•´æ•°æ•°ç»„ `arr`ï¼Œåªæœ‰å¯¹ `arr` è¿›è¡Œé‡ç»„åå¯ä»¥æ»¡è¶³ â€œå¯¹äºæ¯ä¸ª$ 0 <=Â i < len(arr) / 2$ï¼Œéƒ½æœ‰ $arr[2 \times i + 1] = 2 \times arr[2 \times i]$â€Â æ—¶ï¼Œè¿”å› `true`ï¼›å¦åˆ™ï¼Œè¿”å› `false`ã€‚

ç¤ºä¾‹ 1ï¼š
```
è¾“å…¥ï¼šarr = [3,1,3,6]

è¾“å‡ºï¼šfalse
```
ç¤ºä¾‹ 2ï¼š
```
è¾“å…¥ï¼šarr = [2,1,2,6]

è¾“å‡ºï¼šfalse
```
ç¤ºä¾‹ 3ï¼š
```
è¾“å…¥ï¼šarr = [4,-2,2,-4]

è¾“å‡ºï¼štrue

è§£é‡Šï¼šå¯ä»¥ç”¨ [-2,-4] å’Œ [2,4] è¿™ä¸¤ç»„ç»„æˆ [-2,-4,2,4] æˆ–æ˜¯ [2,4,-2,-4]
```

æç¤ºï¼š
* $0 <= arr.length <= 3 \times 10^4$
* `arr.length` æ˜¯å¶æ•°
* $-10^5 <= arr[i] <= 10^5$

---

### é€ä¸ªæ„é€  + ä¼˜å…ˆé˜Ÿåˆ—

æ•´ç†ä¸€ä¸‹é¢˜æ„ï¼šæ˜¯å¦èƒ½å¯¹ `arr` è¿›è¡Œé‡ç»„ï¼Œä½¿å¾—æ¯ä¸€ä¸ªå¥‡æ•°ä½ç½®çš„å€¼å‡æ˜¯å‰ä¸€ä¸ªä½ç½®çš„å€¼çš„ä¸¤å€ï¼Œå³å‡‘æˆ $\frac{n}{2}$ ç»„å½¢å¦‚ $(x, 2 \times x)$ çš„æ•°å¯¹ã€‚

å¯¹äºä¸€ä¸ªä»»æ„çš„æœ‰ç†æ•°è€Œè¨€ï¼Œå¯¹å…¶ä¹˜ $2$ ä»…ä¼šæ”¹å˜æ•°å€¼çš„å¤§å°ï¼Œè€Œä¸ä¼šæ”¹å˜å…¶æ–¹å‘ï¼ˆæ­£è´Ÿæ€§è´¨ï¼‰ã€‚

å› æ­¤å¦‚æœæˆ‘ä»¬æ¯æ¬¡éƒ½æ‹¿æœ€æ¥è¿‘ $0$ çš„å€¼ä½œä¸ºèµ·ç‚¹ï¼Œæ•´ä¸ªæ„é€ è¿‡ç¨‹å°±æ˜¯å”¯ä¸€ç¡®å®šçš„ã€‚

å…·ä½“çš„ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰æ¥å®ç°ï¼Œæ„é€ ä¸€ä¸ªä»¥ä¸ $0$ å€¼è·ç¦»ä½œä¸ºåŸºå‡†çš„å°æ ¹å †ã€‚æ¯æ¬¡ä»å †ä¸­å–å‡ºå…ƒç´  $x$ï¼Œæ ¹æ®å½“å‰å…ƒç´  $x$ æ˜¯å¦è¢«ã€Œé¢„å®šã€è¿‡è¿›è¡Œåˆ†æƒ…å†µè®¨è®ºï¼š

* å½“å‰å€¼ $x$ æ²¡æœ‰è¢«é¢„å®šè¿‡ï¼Œè¯´æ˜ $x$ å¿…ç„¶æ˜¯æ•°å¯¹ä¸­çš„ã€Œç»å¯¹å€¼ã€çš„è¾ƒå°å€¼ï¼Œæ­¤æ—¶ç»™ $x$ å¹¶é¢„å®šä¸€ä¸ª $x \times 2$ï¼Œå³å¯¹ $x \times 2$ çš„é¢„å®šæ¬¡æ•°åŠ ä¸€ï¼›
* å½“å‰å€¼ $x$ å·²ç»è¢«é¢„å®šè¿‡ï¼Œè¯´æ˜ $x$ å’Œæ­¤å‰çš„æŸä¸ªæ•° $\frac{x}{2}$ ç»„æˆè¿‡æ•°å¯¹ï¼Œå¯¹ $x$ çš„é¢„å®šæ¬¡æ•°å‡ä¸€ã€‚

å½“ä¸”ä»…å½“æ„æˆè¿‡ç¨‹ç»“æŸåï¼Œæ‰€æœ‰æ•°çš„ã€Œé¢„å®šã€æ¬¡æ•°ä¸º $0$ æ—¶ï¼Œ`arr` å¯ä»¥å‡‘æˆ $\frac{n}{2}$ ç»„å½¢å¦‚ $(x, 2 \times x)$ çš„æ•°å¯¹ã€‚

> ä¸€äº›ç»†èŠ‚ï¼šç”±äº $arr[i]$ çš„æ•°å€¼èŒƒå›´ä¸º $[-10^5, 10^5]$ï¼ŒåŒæ—¶å­˜åœ¨ä¹˜ $2$ æ“ä½œï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹è®¡ç®—ç»“æœè¿›è¡Œ $2 \times 10^5$ çš„åç§»æ“ä½œï¼Œç¡®ä¿å…¶ä¸ºæ­£æ•°ã€‚

ä»£ç ï¼š
```Java
class Solution {
    static int N = 100010, M = N * 2;
    static int[] cnts = new int[M * 2];
    public boolean canReorderDoubled(int[] arr) {
        Arrays.fill(cnts, 0);
        PriorityQueue<Integer> q = new PriorityQueue<>((a,b)->Math.abs(a)-Math.abs(b));
        for (int i : arr) q.add(i);
        while (!q.isEmpty()) {
            int x = q.poll(), t = x * 2;
            if (cnts[x + M] != 0 && --cnts[x + M] >= 0) continue;
            cnts[t + M]++;
        }
        for (int i = 0; i < M * 2; i++) {
            if (cnts[i] != 0) return false;
        }
        return true;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šä»¤ $n$ ä¸º `arr` é•¿åº¦ï¼Œ$m$ ä¸º $arr[i]$ çš„å€¼åŸŸèŒƒå›´ï¼Œèµ·å§‹å°†æ‰€æœ‰æ•°å€¼æ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰çš„å¤æ‚åº¦ä¸º $O(n\log{n})$ï¼Œä»ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰ä¸­å–å‡ºå¹¶æ„é€ å¤æ‚åº¦ä¸º $O(n\log{n})$ï¼Œæ£€æŸ¥æ„é€ æ˜¯å¦æˆåŠŸå¤æ‚åº¦ä¸º $O(m)$ï¼Œæ•´ä½“å¤æ‚åº¦ä¸º $O(n\log{n} + m)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n + m)$

---

### æˆç»„æ„é€  + æ’åº + é¢„å¤„ç†å‰ªæ

ä¸Šè¿°è§£æ³•ä¸­ï¼Œæˆ‘ä»¬ä¸å¯é¿å…çš„å¯¹ `arr` è¿›è¡Œä¸€éå®Œæˆçš„å°è¯•æ„é€ ï¼Œå¹¶ä¸”åœ¨å°è¯•æ„é€ ç»“æŸåå†è¿›è¡Œä¸€æ¬¡æ€§çš„åˆæ³•æ€§æ£€æŸ¥ã€‚

äº‹å®ä¸Šï¼Œå¦‚æœ `arr` èƒ½å¤Ÿå‡‘æˆ $\frac{n}{2}$ ç»„å½¢å¦‚ $(x, 2 \times x)$ çš„æ•°å¯¹ï¼Œå¹¶ä¸”å¯¹äºæŸä¸ª $x$ å¯èƒ½ä¼šå‡ºç°å¤šæ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿè®¡ $arr[i]$ çš„æ•°é‡ï¼Œå¹¶æ ¹æ®ç»å¯¹å€¼å¤§å°è¿›è¡Œæ’åºï¼Œè¿›è¡Œæˆç»„æ„é€ ï¼š$cnts[x]$ ä¸ª $x$ æ¶ˆè€— $cnts[x]$ ä¸ª $2 \times x$ã€‚

åŒæ—¶ç”±äºæˆ‘ä»¬æå‰é¢„å¤„ç†äº†æ¯ä¸ª $arr[i]$ çš„å‡ºç°æ¬¡æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æå‰çŸ¥é“æ˜¯å¦æœ‰ $cnts[x]$ ä¸ª $2 \times x$ å’Œ $x$ æˆç»„ï¼Œä»è€Œå¯ä»¥è¾¹æ„é€ è¾¹æ£€æŸ¥åˆæ³•æ€§ã€‚

 ä»£ç ï¼š
```Java
class Solution {
    static int N = 100010, M = N * 2;
    static int[] cnts = new int[M * 2];
    public boolean canReorderDoubled(int[] arr) {
        Arrays.fill(cnts, 0);
        List<Integer> list = new ArrayList<>();
        for (int i : arr) {
            if (++cnts[i + M] == 1) list.add(i);
        }
        Collections.sort(list, (a,b)->Math.abs(a)-Math.abs(b));
        for (int i : list) {
            if (cnts[i * 2 + M] < cnts[i + M]) return false;
            cnts[i * 2 + M] -= cnts[i + M];
        }
        return true;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šç»Ÿè®¡ $arr[i]$ çš„å‡ºç°æ¬¡æ•°ä»¥åŠå¯¹ $arr[i]$ å»é‡çš„å¤æ‚åº¦ä¸º $O(n)$ï¼Œå¯¹å»é‡æ•°ç»„è¿›è¡Œæ’åºçš„å¤æ‚åº¦ä¸º $O(n\log{n})$ï¼ŒéªŒè¯æ˜¯å¦åˆæ³•å¤æ‚åº¦ä¸º $O(n)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(n\log{n})$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n + m)$

---

### æˆç»„æ„é€  + æ‹“æ‰‘æ’åº

å¯¹äºä¸Šè¿°ä¸¤ç§è§£æ³•ï¼Œè¦ä¹ˆåˆ©ç”¨ã€Œä¼˜å…ˆé˜Ÿåˆ—ã€è¦ä¹ˆåˆ©ç”¨ã€Œæ’åºã€ï¼Œç›®çš„éƒ½æ˜¯ä¸ºäº†æ‰¾åˆ°æ•°å¯¹ä¸­çš„ã€Œç»å¯¹å€¼è¾ƒå°ã€çš„é‚£ä¸€ä½ï¼Œç„¶åå¼€å§‹å¾€åæ„é€ ã€‚

**äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»»æ„ $x$ åªå¯èƒ½ä¸ $\frac{x}{2}$ æˆ–è€… $2 \times x$ ç»„æˆæ•°å¯¹æ¥è¿›è¡Œå»ºå›¾ï¼Œé€šè¿‡å¯¹å›¾è·‘æ‹“æ‰‘åºæ¥éªŒè¯æ˜¯å¦èƒ½å¤Ÿå‡‘æˆ $\frac{n}{2}$ ç»„å½¢å¦‚ $(x, 2 \times x)$ çš„æ•°å¯¹ã€‚**

> ä¸äº†è§£ã€Œæ‹“æ‰‘æ’åºã€çš„åŒå­¦å¯ä»¥çœ‹å‰ç½® ğŸ§€ï¼š[å›¾è®ºæ‹“æ‰‘æ’åºå…¥é—¨](https%3A//mp.weixin.qq.com/s?__biz%3DMzU4NDE3MTEyMA%3D%3D%26mid%3D2247489706%26idx%3D1%26sn%3D771cd807f39d1ca545640c0ef7e5baec)ï¼Œé‡Œé¢é€šè¿‡å›¾è§£æ¼”ç¤ºäº†ä½•ä¸ºæ‹“æ‰‘åºï¼Œä»¥åŠé€šè¿‡ã€Œåè¯æ³•ã€è¯æ˜äº†ä¸ºä½•æœ‰å‘æ— ç¯å›¾èƒ½å¤Ÿèƒ½å¤Ÿè¿›è¡Œæ‹“æ‰‘æ’åºã€‚

ç‰¹åˆ«çš„ï¼Œæˆ‘ä»¬éœ€è¦ç‰¹æ®Šå¤„ç† $arr[i] = 0$ çš„æƒ…å†µï¼Œç”±äº $0$ åªèƒ½ä¸æœ¬èº«ç»„æˆæ•°å¯¹ï¼Œä¸ºäº†é¿å…è‡ªç¯ï¼Œæˆ‘ä»¬éœ€è¦è·³è¿‡ $arr[i] = 0$ çš„ç‚¹ï¼ŒåŒæ—¶ç‰¹åˆ¤ $arr[i] = 0$ çš„å‡ºç°æ•°é‡ä¸ºå¥‡æ•°æ—¶ï¼Œè¿”å›æ— è§£ã€‚

å’Œè§£æ³•äºŒä¸€æ ·ï¼Œå…ˆå¯¹ $arr[i]$ è¿›è¡Œæ•°é‡ç»Ÿè®¡ä»¥åŠå»é‡é¢„å¤„ç†ï¼ˆè·³è¿‡ $0$ï¼‰ï¼Œç„¶åå¯¹å»é‡æ•°ç»„ `list` ä¸­å‡ºç°çš„æ•°å€¼ $x$ è¿›è¡Œåˆ†æƒ…å†µè®¨è®ºï¼š

* $x$ ä¸ºå¥‡æ•°ï¼Œç”±äº $\frac{x}{2}$ ä¸ä¸ºæ•´æ•°ï¼Œå› æ­¤ $x$ åªèƒ½ä½œä¸ºæ•°å¯¹ä¸­ç»å¯¹å€¼è¾ƒå°çš„é‚£ä¸ªï¼ˆå³ $x$ å…¥åº¦ä¸º $0$ï¼‰ï¼ŒåŠ å…¥é˜Ÿåˆ—ï¼›
* $x$ ä¸ºå¶æ•°ï¼Œé¦–å…ˆä»¤ $x$ çš„å…¥åº¦ $in[x] = cnts[\frac{x}{2}]$ï¼Œä»£è¡¨æœ‰ $cnts[\frac{x}{2}]$ ä¸ª $\frac{x}{2}$ ä¸å…¶å¯¹åº”ã€‚å½“ $in[x] = 0$ æ—¶ï¼Œè¯´æ˜æ²¡æœ‰ $\frac{x}{2}$ ä¸å…¶æˆå¯¹ï¼Œæ­¤æ—¶ $x$ åªèƒ½ä½œä¸ºæ•°å¯¹ä¸­ç»å¯¹å€¼è¾ƒå°çš„é‚£ä¸ªï¼ˆå³ $x$ å…¥åº¦ä¸º $0$ï¼‰ï¼ŒåŠ å…¥é˜Ÿåˆ—ã€‚

è·‘ä¸€éæ‹“æ‰‘æ’åºï¼Œå‡è®¾å½“å‰å‡ºé˜Ÿå€¼ä¸º $t$ï¼Œæ­¤æ—¶éœ€è¦æ¶ˆè€—æ‰ $cnts[t]$ ä¸ª $t \times 2$ ä¸å…¶å½¢æˆæ•°å¯¹ï¼ˆå³ $cnts[t \times 2] -= cnts[t]$ ï¼‰ï¼ŒåŒæ—¶ $t \times 2$ çš„å…¥åº¦ä¹Ÿè¦æ›´æ–°ï¼ˆå³ $in[t \times 2] -= cnts[t]$ ï¼‰ï¼Œè‹¥ $in[t \times 2] = 0$ ä¸”æ­¤æ—¶ $cnts[t \times 2] > 0$ï¼Œå°† $t \times 2$ è¿›è¡Œå…¥é˜Ÿã€‚åŒæ—¶ç”±äºæˆ‘ä»¬æ˜ç¡®å‡å°‘äº† $t \times 2$ çš„æ•°é‡ï¼Œå› æ­¤éœ€è¦åŒæ­¥æ›´æ–° $t \times 4$ çš„å…¥åº¦ï¼ŒåŒç†ï¼Œå½“ $t \times 4$ çš„å…¥åº¦ $in[t \times 4] = 0$ï¼ŒåŒæ—¶ $cnts[t \times 4] > 0$ æ—¶ï¼Œéœ€è¦å°† $t \times 4$ è¿›è¡Œå…¥é˜Ÿã€‚


ä»£ç ï¼š
```Java
class Solution {
    static int N = 100010, M = 2 * N;
    static int[] cnts = new int[M * 2], in = new int[M * 2];
    public boolean canReorderDoubled(int[] arr) {
        Arrays.fill(cnts, 0);
        Arrays.fill(in, 0);
        List<Integer> list = new ArrayList<>();
        for (int i : arr) {
            if (++cnts[i + M] == 1 && i != 0) list.add(i);
        }
        if (cnts[M] % 2 != 0) return false;
        Deque<Integer> d = new ArrayDeque<>();
        for (int i : list) {
            if (i % 2 == 0) {
                in[i + M] = cnts[i / 2 + M];
                if (in[i + M] == 0) d.addLast(i);
            } else { 
                d.addLast(i);
            }
        }
        while (!d.isEmpty()) {
            int t = d.pollFirst();
            if (cnts[t * 2 + M] < cnts[t + M]) return false;
            cnts[t * 2 + M] -= cnts[t + M];
            in[t * 2 + M] -= cnts[t + M];
            if (in[t * 2 + M] == 0 && cnts[t * 2 + M] != 0) d.addLast(t * 2);
            in[t * 4 + M] -= cnts[t + M];
            if (in[t * 4 + M] == 0 && cnts[t * 4 + M] != 0) d.addLast(t * 4);
        }
        return true;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šç»Ÿè®¡æ•°é‡å’Œå…¥åº¦çš„å¤æ‚åº¦ä¸º $O(n)$ï¼›è·‘æ‹“æ‰‘åºéªŒè¯çš„å¤æ‚åº¦ä¸º $O(n)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n + m)$

---

### æœ€å

è¿™æ˜¯æˆ‘ä»¬ã€Œåˆ·ç©¿ LeetCodeã€ç³»åˆ—æ–‡ç« çš„ç¬¬ `No.954` ç¯‡ï¼Œç³»åˆ—å¼€å§‹äº 2021/01/01ï¼Œæˆªæ­¢äºèµ·å§‹æ—¥ LeetCode ä¸Šå…±æœ‰ 1916 é“é¢˜ç›®ï¼Œéƒ¨åˆ†æ˜¯æœ‰é”é¢˜ï¼Œæˆ‘ä»¬å°†å…ˆæŠŠæ‰€æœ‰ä¸å¸¦é”çš„é¢˜ç›®åˆ·å®Œã€‚

åœ¨è¿™ä¸ªç³»åˆ—æ–‡ç« é‡Œé¢ï¼Œé™¤äº†è®²è§£è§£é¢˜æ€è·¯ä»¥å¤–ï¼Œè¿˜ä¼šå°½å¯èƒ½ç»™å‡ºæœ€ä¸ºç®€æ´çš„ä»£ç ã€‚å¦‚æœæ¶‰åŠé€šè§£è¿˜ä¼šç›¸åº”çš„ä»£ç æ¨¡æ¿ã€‚

ä¸ºäº†æ–¹ä¾¿å„ä½åŒå­¦èƒ½å¤Ÿç”µè„‘ä¸Šè¿›è¡Œè°ƒè¯•å’Œæäº¤ä»£ç ï¼Œæˆ‘å»ºç«‹äº†ç›¸å…³çš„ä»“åº“ï¼šhttps://github.com/SharingSource/LogicStack-LeetCode ã€‚

åœ¨ä»“åº“åœ°å€é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°ç³»åˆ—æ–‡ç« çš„é¢˜è§£é“¾æ¥ã€ç³»åˆ—æ–‡ç« çš„ç›¸åº”ä»£ç ã€LeetCode åŸé¢˜é“¾æ¥å’Œå…¶ä»–ä¼˜é€‰é¢˜è§£ã€‚

