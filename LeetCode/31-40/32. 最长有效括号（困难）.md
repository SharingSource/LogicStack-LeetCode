### é¢˜ç›®æè¿°

è¿™æ˜¯ LeetCode ä¸Šçš„ **[32. æœ€é•¿æœ‰æ•ˆæ‹¬å·](https://leetcode.cn/problems/longest-valid-parentheses/solutions/577327/shua-chuan-lc-miao-dong-xi-lie-shi-yong-95ezk/)** ï¼Œéš¾åº¦ä¸º **å›°éš¾**ã€‚

Tag : ã€Œæ ˆã€ã€ã€Œæ‹¬å·é—®é¢˜ã€



ç»™ä½ ä¸€ä¸ªåªåŒ…å« `'('`Â å’Œ `')'`Â çš„å­—ç¬¦ä¸²ï¼Œæ‰¾å‡ºæœ€é•¿æœ‰æ•ˆï¼ˆæ ¼å¼æ­£ç¡®ä¸”è¿ç»­ï¼‰æ‹¬å·å­ä¸²çš„é•¿åº¦ã€‚

ç¤ºä¾‹ 1ï¼š
```
è¾“å…¥ï¼šs = "(()"

è¾“å‡ºï¼š2

è§£é‡Šï¼šæœ€é•¿æœ‰æ•ˆæ‹¬å·å­ä¸²æ˜¯ "()"
```
ç¤ºä¾‹ 2ï¼š
```
è¾“å…¥ï¼šs = ")()())"

è¾“å‡ºï¼š4

è§£é‡Šï¼šæœ€é•¿æœ‰æ•ˆæ‹¬å·å­ä¸²æ˜¯ "()()"
```
ç¤ºä¾‹ 3ï¼š
```
è¾“å…¥ï¼šs = ""

è¾“å‡ºï¼š0
```

æç¤ºï¼š
* $0 <= s.length <= 3 \times 10^4$
* $s[i]$ ä¸º `'('` æˆ– `')'`


---

### æ ˆ

ä»å‰å¾€åæ‰«æå­—ç¬¦ä¸² `s`ã€‚

ç”¨ `i` æ¥è®°å½•å½“å‰éå†åˆ°çš„ä½ç½®ï¼Œç”¨ `j` æ¥è®°å½•æœ€è¿‘çš„æœ€é•¿æœ‰æ•ˆæ‹¬å·çš„å¼€å§‹ä½ç½®çš„ã€Œå‰ä¸€ä¸ªä½ç½®ã€ã€‚

åªå¯¹ `'('` è¿›è¡Œå…¥æ ˆï¼ˆå…¥æ ˆçš„æ˜¯å¯¹åº”çš„ä¸‹æ ‡ï¼‰ï¼Œå½“éå†åˆ° `')'` çš„æ—¶å€™ï¼Œç”±äºæ ˆä¸­åªæœ‰ `'('`ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¼¹å‡ºä¸€ä¸ª `'('` ä¸ä¹‹åŒ¹é…ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚

å†æ£€æŸ¥æ ˆä¸­æ˜¯å¦è¿˜æœ‰ `'('`ï¼Œå¦‚æœæœ‰ä½¿ç”¨æ ˆé¡¶å…ƒç´ çš„ä¸‹æ ‡æ¥è®¡ç®—é•¿åº¦ï¼Œå¦åˆ™ä½¿ç”¨ `j` ä¸‹æ ‡æ¥è®¡ç®—é•¿åº¦ã€‚

è¯¥åšæ³•çš„æœ¬è´¨ï¼š**æ ˆé‡Œåªå­˜æ”¾å¾…åŒ¹é…çš„ `(` ç¬¦å·ï¼Œè™½ç„¶è¿™äº› `(` åœ¨åŸå­—ç¬¦ä¸²ä¸­çš„ä¸‹æ ‡ä¸ä¸€å®šè¿ç»­ï¼Œä½† `(` ä¹‹é—´ä¸€å®šä¸ºæœ‰æ•ˆæ‹¬å·ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ ˆé¡¶å…ƒç´ ä½œä¸ºæœ‰æ•ˆæ‹¬å·çš„å·¦è¾¹ç•Œè®¡ç®—é•¿åº¦**ã€‚

ä¸¾ä¸ª ğŸŒ°ï¼Œå¯¹äº `s` = `((())((` çš„æƒ…å†µï¼Œå½“æ•´ä¸ªå­—ç¬¦ä¸²å¤„ç†å®Œï¼Œæ ˆå†…å‰©ä¸‹çš„ä¸æ˜¯æ‰€æœ‰çš„ `(` ç¬¦å·ï¼ˆä¸æ˜¯ $5$ ä¸ªï¼‰ï¼Œè€Œæ˜¯å‰©ä½™å¾…åŒ¹é…çš„ `(` ç¬¦å·ï¼ˆè€Œæ˜¯ $3$ ä¸ªï¼Œå³ä»å·¦å¾€å³ç¬¬ $1$ã€$4$ å’Œ $5$ ä¸ª `(`ï¼‰ï¼Œè™½ç„¶ç¬¬ $1$ å’Œç¬¬ $4$ ä¸ª `(` ç¬¦å·åœ¨ `s` ä¸­ä¸è¿ç»­ï¼Œä½†å…¶ä¹‹é—´å¿…ç„¶æ˜¯æœ‰æ•ˆæ‹¬å·ã€‚

Java ä»£ç ï¼š
```Java
class Solution {
    public int longestValidParentheses(String s) {
        Deque<Integer> d = new ArrayDeque<>();
        int n = s.length(), ans = 0;
        for (int i = 0, j = -1; i < n; i++) {
            if (s.charAt(i) == '(') {
                d.addLast(i);
            } else {
                if (!d.isEmpty()) {
                    d.pollLast();
                    int top = j;
                    if (!d.isEmpty()) top = d.peekLast();
                    ans = Math.max(ans, i - top);
                } else {
                    j = i;
                }
            }
        }
        return ans;
    }
}
```
C++ ä»£ç ï¼š
```C++
class Solution {
public:
    int longestValidParentheses(string s) {
        stack<int> d;
        int n = s.length(), ans = 0;
        for (int i = 0, j = -1; i < n; i++) {
            if (s[i] == '(') {
                d.push(i);
            } else {
                if (!d.empty()) {
                    d.pop();
                    int top = j;
                    if (!d.empty()) top = d.top();
                    ans = max(ans, i - top);
                } else {
                    j = i;
                }
            }
        }
        return ans;
    }
};
```
Python ä»£ç ï¼š
```Python
from collections import deque

class Solution:
    def longestValidParentheses(self, s: str) -> int:
        d = deque()
        n, ans, j = len(s), 0, -1
        for i in range(n):
            if s[i] == '(':
                d.append(i)
            else:
                if d:
                    d.pop()
                    top = j
                    if d: top = d[-1]
                    ans = max(ans, i - top)
                else:
                    j = i
        return ans
```
TypeScript ä»£ç ï¼š
```TypeScript
function longestValidParentheses(s: string): number {
    const d: number[] = [];
    let n = s.length, ans = 0;
    for (let i = 0, j = -1; i < n; i++) {
        if (s[i] === '(') {
            d.push(i);
        } else {
            if (d.length) {
                d.pop();
                let top = j;
                if (d.length) top = d[d.length - 1]
                ans = Math.max(ans, i - top);
            } else {
                j = i;
            }
        }
    }
    return ans;
};
```
* æ—¶é—´å¤æ‚åº¦ï¼šæ¯ä¸ªå­—ç¬¦æœ€å¤šè¿›æ ˆå’Œå‡ºæ ˆä¸€æ¬¡ï¼Œå¤æ‚åº¦ä¸º $O(n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

### æœ€å

è¿™æ˜¯æˆ‘ä»¬ã€Œåˆ·ç©¿ LeetCodeã€ç³»åˆ—æ–‡ç« çš„ç¬¬ `No.32` ç¯‡ï¼Œç³»åˆ—å¼€å§‹äº 2021/01/01ï¼Œæˆªæ­¢äºèµ·å§‹æ—¥ LeetCode ä¸Šå…±æœ‰ 1916 é“é¢˜ç›®ï¼Œéƒ¨åˆ†æ˜¯æœ‰é”é¢˜ï¼Œæˆ‘ä»¬å°†å…ˆæŠŠæ‰€æœ‰ä¸å¸¦é”çš„é¢˜ç›®åˆ·å®Œã€‚

åœ¨è¿™ä¸ªç³»åˆ—æ–‡ç« é‡Œé¢ï¼Œé™¤äº†è®²è§£è§£é¢˜æ€è·¯ä»¥å¤–ï¼Œè¿˜ä¼šå°½å¯èƒ½ç»™å‡ºæœ€ä¸ºç®€æ´çš„ä»£ç ã€‚å¦‚æœæ¶‰åŠé€šè§£è¿˜ä¼šç›¸åº”çš„ä»£ç æ¨¡æ¿ã€‚

ä¸ºäº†æ–¹ä¾¿å„ä½åŒå­¦èƒ½å¤Ÿç”µè„‘ä¸Šè¿›è¡Œè°ƒè¯•å’Œæäº¤ä»£ç ï¼Œæˆ‘å»ºç«‹äº†ç›¸å…³çš„ä»“åº“ï¼šhttps://github.com/SharingSource/LogicStack-LeetCode ã€‚

åœ¨ä»“åº“åœ°å€é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°ç³»åˆ—æ–‡ç« çš„é¢˜è§£é“¾æ¥ã€ç³»åˆ—æ–‡ç« çš„ç›¸åº”ä»£ç ã€LeetCode åŸé¢˜é“¾æ¥å’Œå…¶ä»–ä¼˜é€‰é¢˜è§£ã€‚

