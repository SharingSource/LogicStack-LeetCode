### é¢˜ç›®æè¿°

è¿™æ˜¯ LeetCode ä¸Šçš„ **[433. æœ€å°åŸºå› å˜åŒ–](https://leetcode-cn.com/problems/minimum-genetic-mutation/solution/by-ac_oier-74b4/)** ï¼Œéš¾åº¦ä¸º **ä¸­ç­‰**ã€‚

Tag : ã€ŒBFSã€ã€ã€ŒåŒå‘ BFSã€ã€ã€ŒA* ç®—æ³•ã€ã€ã€Œå¯å‘å¼æœç´¢ã€



åŸºå› åºåˆ—å¯ä»¥è¡¨ç¤ºä¸ºä¸€æ¡ç”± $8$ ä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­æ¯ä¸ªå­—ç¬¦éƒ½æ˜¯ `'A'`ã€`'C'`ã€`'G'` å’Œ `'T'` ä¹‹ä¸€ã€‚

å‡è®¾æˆ‘ä»¬éœ€è¦è°ƒæŸ¥ä»åŸºå› åºåˆ—Â `start` å˜ä¸º `end` æ‰€å‘ç”Ÿçš„åŸºå› å˜åŒ–ã€‚ä¸€æ¬¡åŸºå› å˜åŒ–å°±æ„å‘³ç€è¿™ä¸ªåŸºå› åºåˆ—ä¸­çš„ä¸€ä¸ªå­—ç¬¦å‘ç”Ÿäº†å˜åŒ–ã€‚

* ä¾‹å¦‚ï¼Œ`"AACCGGTT" --> "AACCGGTA"` å°±æ˜¯ä¸€æ¬¡åŸºå› å˜åŒ–ã€‚

å¦æœ‰ä¸€ä¸ªåŸºå› åº“ `bank` è®°å½•äº†æ‰€æœ‰æœ‰æ•ˆçš„åŸºå› å˜åŒ–ï¼Œåªæœ‰åŸºå› åº“ä¸­çš„åŸºå› æ‰æ˜¯æœ‰æ•ˆçš„åŸºå› åºåˆ—ã€‚

ç»™ä½ ä¸¤ä¸ªåŸºå› åºåˆ— `start` å’Œ `end` ï¼Œä»¥åŠä¸€ä¸ªåŸºå› åº“ `bank` ï¼Œè¯·ä½ æ‰¾å‡ºå¹¶è¿”å›èƒ½å¤Ÿä½¿Â `start` å˜åŒ–ä¸º `end` æ‰€éœ€çš„æœ€å°‘å˜åŒ–æ¬¡æ•°ã€‚å¦‚æœæ— æ³•å®Œæˆæ­¤åŸºå› å˜åŒ–ï¼Œè¿”å› $-1$ ã€‚

æ³¨æ„ï¼šèµ·å§‹åŸºå› åºåˆ—Â `start` é»˜è®¤æ˜¯æœ‰æ•ˆçš„ï¼Œä½†æ˜¯å®ƒå¹¶ä¸ä¸€å®šä¼šå‡ºç°åœ¨åŸºå› åº“ä¸­ã€‚

ç¤ºä¾‹ 1ï¼š
```
è¾“å…¥ï¼šstart = "AACCGGTT", end = "AACCGGTA", bank = ["AACCGGTA"]

è¾“å‡ºï¼š1
```
ç¤ºä¾‹ 2ï¼š
```
è¾“å…¥ï¼šstart = "AACCGGTT", end = "AAACGGTA", bank = ["AACCGGTA","AACCGCTA","AAACGGTA"]

è¾“å‡ºï¼š2
```
ç¤ºä¾‹ 3ï¼š
```
è¾“å…¥ï¼šstart = "AAAAACCC", end = "AACCCCCC", bank = ["AAAACCCC","AAACCCCC","AACCCCCC"]

è¾“å‡ºï¼š3
```
æç¤ºï¼š
* $start.length == 8$
* $end.length == 8$
* $0 <= bank.length <= 10$
* $bank[i].length == 8$
* `start`ã€`end` å’Œ `bank[i]` ä»…ç”±å­—ç¬¦ `['A', 'C', 'G', 'T']` ç»„æˆ

---

### BFS

ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä»¤ $S = start$ã€ $T = end$ï¼Œå°†æ¯ä¸ªåŸºå› åºåˆ—è§†ä¸ºã€ŒçŠ¶æ€ã€ã€‚

å®¹æ˜“æƒ³åˆ°ä½¿ç”¨ `BFS`  è¿›è¡Œæ±‚è§£ï¼Œå¹¶ä½¿ç”¨ã€Œå“ˆå¸Œè¡¨ã€è®°å½•åˆ°è¾¾æŸä¸ªçŠ¶æ€æ‰€æ¶ˆè€—çš„æ­¥æ•°ï¼ˆåŒæ—¶ä¸ºäº†å¿«é€Ÿåˆ¤æ–­æŸä¸ªçŠ¶æ€æ˜¯å¦åˆæ³•ï¼Œæˆ‘ä»¬ä½¿ç”¨ `Set` ç»“æ„å¯¹ $back[i]$ è¿›è¡Œè½¬å­˜ï¼‰ã€‚

èµ·å§‹å°† `S` åŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶æ›´æ–°åˆ°è¾¾ `S` æ‰€ä½¿ç”¨çš„æ­¥æ•°ä¸º $0$ï¼Œç„¶åè¿›è¡Œå¸¸è§„çš„ `BFS` è¿‡ç¨‹ï¼šæ¯æ¬¡å–å‡ºé˜Ÿå¤´å…ƒç´ ï¼Œå°è¯•æ›¿æ¢å½“å‰çŠ¶æ€çš„æŸä¸€ä½ï¼Œæ¥å¾—åˆ°æ–°çš„çŠ¶æ€ï¼ˆé™å®šæ–°çŠ¶æ€å¿…é¡»åˆæ³•ï¼Œå³å¿…é¡»å‡ºç°åœ¨ `Set` ä¸­ï¼‰ï¼Œå¦‚æœæ–°çŠ¶æ€åˆæ³•å¹¶ä¸”æ²¡æœ‰åœ¨è®°å½•æ­¥æ•°çš„å“ˆå¸Œè¡¨ä¸­å‡ºç°è¿‡ï¼Œåˆ™å°†æ–°çŠ¶æ€å…¥é˜Ÿå¹¶æ›´æ–°å¾—åˆ°æ–°çŠ¶æ€æ‰€ç”¨æ­¥æ•°ï¼Œå¦åˆ™ä¸¢å¼ƒæ–°çŠ¶æ€ã€‚

é‡å¤ä¸Šè¿°è¿‡ç¨‹ç›´åˆ°æ‰¾åˆ° `T`ï¼ˆè¿”å›å…·ä½“æ­¥æ•°ï¼‰ æˆ–è€…é˜Ÿåˆ—ä¸ºç©ºï¼ˆè¿”å› $-1$ï¼‰ã€‚

ä»£ç ï¼š
```Java
class Solution {
    static char[] items = new char[]{'A', 'C', 'G', 'T'};
    public int minMutation(String S, String T, String[] bank) {
        Set<String> set = new HashSet<>();
        for (String s : bank) set.add(s);
        Deque<String> d = new ArrayDeque<>();
        Map<String, Integer> map = new HashMap<>();
        d.addLast(S);
        map.put(S, 0);
        while (!d.isEmpty()) {
            int size = d.size();
            while (size-- > 0) {
                String s = d.pollFirst();
                char[] cs = s.toCharArray();
                int step = map.get(s);
                for (int i = 0; i < 8; i++) {
                    for (char c : items) {
                        if (cs[i] == c) continue;
                        char[] clone = cs.clone();
                        clone[i] = c;
                        String sub = String.valueOf(clone);
                        if (!set.contains(sub)) continue;
                        if (map.containsKey(sub)) continue;
                        if (sub.equals(T)) return step + 1;
                        map.put(sub, step + 1);
                        d.addLast(sub);
                    }
                }
            }
        }
        return -1;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šä»¤ $n$ ä¸º `bank` çš„æ•°ç»„é•¿åº¦ï¼ˆåˆæ³•çŠ¶æ€æ•°ï¼‰ï¼Œå°† `back` å­˜å…¥ `Set` ç»“æ„å¤æ‚åº¦ä¸º $O(n)$ï¼Œæ¯ä¸ªçŠ¶æ€ç»è¿‡ä¸€æ­¥æ“ä½œæœ€å¤šæ‹“å±•å‡º $C = 32$ ä¸ªæ–°åŸºå› ï¼ˆå…±æœ‰ $8$ ä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®æœ‰ $4$ ä¸ªé€‰æ‹©ï¼‰ï¼Œ`BFS`  è¿‡ç¨‹å¤æ‚åº¦ä¸º $O(C * n)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º  $O(C * n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

### åŒå‘ BFS

åŒç†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ã€ŒåŒå‘ `BFS`ã€è¿›è¡Œæ±‚è§£ã€‚

åŒå‘ `BFS` ä¸å¸¸è§„ `BFS`  ç›¸æ¯”ï¼Œèƒ½å¤Ÿæœ‰æ•ˆè§£å†³ã€Œæœç´¢ç©ºé—´çˆ†ç‚¸ã€çš„é—®é¢˜ï¼š

![](https://pic.leetcode-cn.com/1623894968-XELIvK-image.png)

å¯¹åŒå‘ `BFS`  ä¸ç†Ÿæ‚‰çš„åŒå­¦å¯ä»¥çœ‹å‰ç½®ğŸ§€ï¼š[(é¢˜è§£) 127. å•è¯æ¥é¾™](https://leetcode-cn.com/problems/word-ladder/solution/gong-shui-san-xie-ru-he-shi-yong-shuang-magjd/)ã€‚

ä»£ç ï¼š
```Java
class Solution {
    String S, T;
    Set<String> set = new HashSet<>();
    static char[] items = new char[]{'A','C','G','T'};
    public int minMutation(String _s, String _e, String[] bank) {
        S = _s; T = _e;
        for (String s : bank) set.add(s);
        return bfs();
    }
    int bfs() {
        Deque<String> d1 = new ArrayDeque<>(), d2 = new ArrayDeque<>();
        Map<String, Integer> m1 = new HashMap<>(), m2 = new HashMap<>();
        d1.addLast(S); m1.put(S, 0);
        d2.addLast(T); m2.put(T, 0);
        while (!d1.isEmpty() && !d2.isEmpty()) {
            int t = -1;
            if (d1.size() <= d2.size()) t = update(d1, m1, m2);    
            else t = update(d2, m2, m1);
            if (t != -1) return t;
        }
        return -1;
    }
    int update(Deque<String> d, Map<String, Integer> cur, Map<String, Integer> other) {
        int size = d.size();
        while (size-- > 0) {
            String s = d.pollFirst();
            char[] cs = s.toCharArray();
            int step = cur.get(s);
            for (int i = 0; i < 8; i++) {
                for (char c : items) {
                    if (cs[i] == c) continue;
                    char[] clone = cs.clone();
                    clone[i] = c;
                    String sub = String.valueOf(clone);
                    if (!set.contains(sub)) continue;
                    if (other.containsKey(sub)) return step + 1 + other.get(sub);
                    if (!cur.containsKey(sub) || cur.get(sub) > step + 1) {
                        cur.put(sub, step + 1);
                        d.addLast(sub);
                    }
                }
            }
        }
        return -1;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šä»¤ $n$ ä¸º `bank` çš„æ•°ç»„é•¿åº¦ï¼ˆåˆæ³•çŠ¶æ€æ•°ï¼‰ï¼Œå°† `back` å­˜å…¥ `Set` ç»“æ„å¤æ‚åº¦ä¸º $O(n)$ï¼Œæ¯ä¸ªçŠ¶æ€ç»è¿‡ä¸€æ­¥æ“ä½œæœ€å¤šæ‹“å±•å‡º $C = 32$ ä¸ªæ–°åŸºå› ï¼ˆå…±æœ‰ $8$ ä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®æœ‰ $4$ ä¸ªé€‰æ‹©ï¼‰ï¼Œ`BFS`  è¿‡ç¨‹å¤æ‚åº¦ä¸º $O(C * n)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º  $O(C * n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$

---

### A* ç®—æ³•

è‹¥ä¸è€ƒè™‘ `bank` çš„é™åˆ¶ï¼Œå¯¹äºä¸€ä¸ªç‰¹å®šçŠ¶æ€è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥ä»»æ„é€‰æ‹©ä¸€ä½æ›¿æ¢ä¸º $4$ ç±»å­—ç¬¦ä¹‹ä¸€ï¼Œå› æ­¤å¯¹äºä»»æ„çŠ¶æ€ $x$ è€Œè¨€ï¼Œå…¶ä¸ç›®æ ‡çŠ¶æ€ $T$ çš„ã€Œç†è®ºæœ€å°è½¬æ¢æ­¥æ•°ã€ä¸ºä¸¤è€…å¯¹åº”ä½ç½®ä¸åŒå­—ç¬¦çš„æ•°é‡ï¼Œè€Œç”±äºå­˜åœ¨ `bank` é™åˆ¶ï¼Œå®é™…æœ€å°æ­¥æ•°å¿…ç„¶æ»¡è¶³ã€Œå¤§äºç­‰äºã€è¯¥ç†è®ºæœ€å°è½¬æ¢æ­¥æ•°ã€‚

åŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å½“å‰çŠ¶æ€åˆ°ç›®æ ‡çŠ¶æ€çš„ã€Œç†è®ºæœ€å°è½¬æ¢æ­¥æ•°ã€ä½œä¸ºå¯å‘å¼å‡½æ•°ï¼Œè¿›è¡Œå¯å‘å¼æœç´¢ã€‚

å…·ä½“çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰ç»´æŠ¤æ‰€æœ‰çš„çŠ¶æ€ï¼Œæ¯æ¬¡ä¼˜å…ˆã€Œå¯å‘å€¼ = ç†è®ºæœ€å°è½¬æ¢æ­¥æ•°ã€çš„çŠ¶æ€è¿›è¡Œä¼˜å…ˆå‡ºé˜Ÿæ‹“å±•ã€‚

å¯¹ã€ŒA* ç®—æ³•ã€ä¸äº†è§£çš„åŒå­¦å¯ä»¥çœ‹å‰ç½® ğŸ§€ï¼š[å‘æŒ¥ A* ç®—æ³•æœ€å¤§ä»·å€¼çš„å…³é”®ç‚¹](https%3A//mp.weixin.qq.com/s?__biz%3DMzU4NDE3MTEyMA%3D%3D%26mid%3D2247489588%26idx%3D1%26sn%3D479e4c0627247ab7e20af7909f2a8b64)ã€‚

ä»£ç ï¼š
```Java
class Solution {
    class Node {
        String s;
        int val;
        Node(String _s) {
            s = _s;
            for (int i = 0; i < 8; i++) {
                if (s.charAt(i) != T.charAt(i)) val++;
            }
        }
    }
    static char[] items = new char[]{'A', 'C', 'G', 'T'};
    String S, T;
    public int minMutation(String start, String end, String[] bank) {
        Set<String> set = new HashSet<>();
        for (String s : bank) set.add(s);
        S = start; T = end;
        PriorityQueue<Node> q = new PriorityQueue<>((a,b)->a.val-b.val);
        Map<String, Integer> map = new HashMap<>();
        q.add(new Node(S));
        map.put(S, 0);
        while (!q.isEmpty()) {
            Node node = q.poll();
            char[] cs = node.s.toCharArray();
            int step = map.get(node.s);
            for (int i = 0; i < 8; i++) {
                for (char c : items) {
                    if (cs[i] == c) continue;
                    char[] clone = cs.clone();
                    clone[i] = c;
                    String sub = String.valueOf(clone);
                    if (!set.contains(sub)) continue;
                    if (sub.equals(T)) return step + 1;
                    if (!map.containsKey(sub) || map.get(sub) > step + 1) {
                        map.put(sub, step + 1);
                        q.add(new Node(sub));
                    }
                }
            }
        }
        return -1;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šå¯å‘å¼æœç´¢åˆ†ææ—¶ç©ºå¤æ‚åº¦æ„ä¹‰ä¸å¤§
* ç©ºé—´å¤æ‚åº¦ï¼šå¯å‘å¼æœç´¢åˆ†ææ—¶ç©ºå¤æ‚åº¦æ„ä¹‰ä¸å¤§

---

### æœ€å

è¿™æ˜¯æˆ‘ä»¬ã€Œåˆ·ç©¿ LeetCodeã€ç³»åˆ—æ–‡ç« çš„ç¬¬ `No.433` ç¯‡ï¼Œç³»åˆ—å¼€å§‹äº 2021/01/01ï¼Œæˆªæ­¢äºèµ·å§‹æ—¥ LeetCode ä¸Šå…±æœ‰ 1916 é“é¢˜ç›®ï¼Œéƒ¨åˆ†æ˜¯æœ‰é”é¢˜ï¼Œæˆ‘ä»¬å°†å…ˆæŠŠæ‰€æœ‰ä¸å¸¦é”çš„é¢˜ç›®åˆ·å®Œã€‚

åœ¨è¿™ä¸ªç³»åˆ—æ–‡ç« é‡Œé¢ï¼Œé™¤äº†è®²è§£è§£é¢˜æ€è·¯ä»¥å¤–ï¼Œè¿˜ä¼šå°½å¯èƒ½ç»™å‡ºæœ€ä¸ºç®€æ´çš„ä»£ç ã€‚å¦‚æœæ¶‰åŠé€šè§£è¿˜ä¼šç›¸åº”çš„ä»£ç æ¨¡æ¿ã€‚

ä¸ºäº†æ–¹ä¾¿å„ä½åŒå­¦èƒ½å¤Ÿç”µè„‘ä¸Šè¿›è¡Œè°ƒè¯•å’Œæäº¤ä»£ç ï¼Œæˆ‘å»ºç«‹äº†ç›¸å…³çš„ä»“åº“ï¼šhttps://github.com/SharingSource/LogicStack-LeetCode ã€‚

åœ¨ä»“åº“åœ°å€é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°ç³»åˆ—æ–‡ç« çš„é¢˜è§£é“¾æ¥ã€ç³»åˆ—æ–‡ç« çš„ç›¸åº”ä»£ç ã€LeetCode åŸé¢˜é“¾æ¥å’Œå…¶ä»–ä¼˜é€‰é¢˜è§£ã€‚

