### é¢˜ç›®æè¿°

è¿™æ˜¯ LeetCode ä¸Šçš„ **[211. æ·»åŠ ä¸æœç´¢å•è¯ - æ•°æ®ç»“æ„è®¾è®¡](https://leetcode-cn.com/problems/design-add-and-search-words-data-structure/solution/gong-shui-san-xie-yi-ti-shuang-jie-er-we-un94/)** ï¼Œéš¾åº¦ä¸º **ä¸­ç­‰**ã€‚

Tag : ã€ŒDFSã€ã€ã€Œå­—å…¸æ ‘ã€

è¯·ä½ è®¾è®¡ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæ”¯æŒ æ·»åŠ æ–°å•è¯ å’Œ æŸ¥æ‰¾å­—ç¬¦ä¸²æ˜¯å¦ä¸ä»»ä½•å…ˆå‰æ·»åŠ çš„å­—ç¬¦ä¸²åŒ¹é… ã€‚

å®ç°è¯å…¸ç±» `WordDictionary` ï¼š
* `WordDictionary()` åˆå§‹åŒ–è¯å…¸å¯¹è±¡
* `void addWord(word)` å°† `word` æ·»åŠ åˆ°æ•°æ®ç»“æ„ä¸­ï¼Œä¹‹åå¯ä»¥å¯¹å®ƒè¿›è¡ŒåŒ¹é…
* `bool search(word)` å¦‚æœæ•°æ®ç»“æ„ä¸­å­˜åœ¨å­—ç¬¦ä¸²ä¸Â `word` åŒ¹é…ï¼Œåˆ™è¿”å› `true` ï¼›å¦åˆ™ï¼Œè¿”å›Â  `false` 
* `word` ä¸­å¯èƒ½åŒ…å«ä¸€äº› `'.'` ï¼Œæ¯ä¸ªÂ `.` éƒ½å¯ä»¥è¡¨ç¤ºä»»ä½•ä¸€ä¸ªå­—æ¯ã€‚

ç¤ºä¾‹ï¼š
```
è¾“å…¥ï¼š
["WordDictionary","addWord","addWord","addWord","search","search","search","search"]
[[],["bad"],["dad"],["mad"],["pad"],["bad"],[".ad"],["b.."]]

è¾“å‡ºï¼š
[null,null,null,null,false,true,true,true]

è§£é‡Šï¼š
WordDictionary wordDictionary = new WordDictionary();
wordDictionary.addWord("bad");
wordDictionary.addWord("dad");
wordDictionary.addWord("mad");
wordDictionary.search("pad"); // return False
wordDictionary.search("bad"); // return True
wordDictionary.search(".ad"); // return True
wordDictionary.search("b.."); // return True
```

æç¤ºï¼š
* $1 <= word.length <= 500$
* `addWord` ä¸­çš„ `word` ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ
* `search` ä¸­çš„ `word` ç”± `'.'` æˆ–å°å†™è‹±æ–‡å­—æ¯ç»„æˆ
* æœ€å¤šè°ƒç”¨ $50000$ æ¬¡ `addWord` å’Œ `search`

---

### åŸºæœ¬åˆ†æ

ä¸€é“ $Trie$ çš„è½»åº¦å˜å½¢æ¨¡æ¿é¢˜ï¼Œè¿˜ä¸ç†Ÿæ‚‰ $Trie$ çš„åŒå­¦å¯ä»¥çœ‹ [è¿™é‡Œ](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247488490&idx=1&sn=db2998cb0e5f08684ee1b6009b974089&chksm=fd9cb8f5caeb31e3f7f67dba981d8d01a24e26c93ead5491edb521c988adc0798d8acb6f9e9d&token=1006889101&lang=zh_CN#rd)ï¼Œé‡Œé¢è¯¦ç»†ä»‹ç»äº†å®ç° $Trie$ çš„ä¸¤ç§æ–¹å¼ã€æ³¨æ„äº‹é¡¹ä»¥åŠ $Trie$ åº”ç”¨é¢ç­‰ç­‰ï¼Œæ˜¯è§£å†³æœ¬é¢˜çš„å‰ç½®èŠå£« ğŸ§€ã€‚

ç®€å•å›é¡¾ä¸€ä¸‹ï¼š

$Trie$ æ ‘ï¼ˆåˆå«ã€Œå‰ç¼€æ ‘ã€æˆ–ã€Œå­—å…¸æ ‘ã€ï¼‰æ˜¯ä¸€ç§ç”¨äºå¿«é€ŸæŸ¥è¯¢ã€ŒæŸä¸ªå­—ç¬¦ä¸²/å­—ç¬¦å‰ç¼€ã€æ˜¯å¦å­˜åœ¨çš„æ•°æ®ç»“æ„ã€‚

å…¶æ ¸å¿ƒæ˜¯ä½¿ç”¨ã€Œè¾¹ã€æ¥ä»£è¡¨æœ‰æ— å­—ç¬¦ï¼Œä½¿ç”¨ã€Œç‚¹ã€æ¥è®°å½•æ˜¯å¦ä¸ºã€Œå•è¯ç»“å°¾ã€ä»¥åŠã€Œå…¶åç»­å­—ç¬¦ä¸²çš„å­—ç¬¦æ˜¯ä»€ä¹ˆã€ã€‚

![IMG_1659.PNG](https://pic.leetcode-cn.com/1618369228-slAfrQ-IMG_1659.PNG)


å›åˆ°æœ¬é¢˜ï¼Œ**é¦–å…ˆ `addWord` æ“ä½œä¸ä¼šå¸¦ `.` ç¬¦å·ï¼Œå› æ­¤æˆ‘ä»¬é‡‡ç”¨åŸæœ‰çš„ $Trie$ æ’å…¥æ–¹å¼å³å¯ï¼›è€Œåœ¨ `search` æ“ä½œä¸­ä¼šæœ‰ `.` ç¬¦å·ï¼Œæˆ‘ä»¬éœ€è¦æšä¸¾æŸä¸ª `.` æ‰€ä»£æŒ‡çš„å­—æ¯æ˜¯ä»€ä¹ˆï¼Œè¿™éœ€è¦ç»“åˆ `DFS` æ¥åšã€‚**

---

### äºŒç»´æ•°ç»„

ä½¿ç”¨æ•°ç»„å®ç°ï¼Œéœ€è¦é¢„å…ˆä¼°ç®—æ•°ç»„å¤§å°ã€‚

é€šå¸¸ä¼°ç®—å€¼ä¼šå¾ˆå¤§ï¼Œç›´æ¥ä½¿ç”¨ä¼°ç®—å€¼ä¼š MLEã€‚åˆ©ç”¨ $Trie$  ä¼šæœ‰å¾ˆå¤šä½ç½®è¢«å…±ç”¨ï¼Œä»¥åŠåˆæ ¼çš„æµ‹è¯•ç”¨ä¾‹ï¼Œåº”è¯¥è‡³å°‘åšåˆ°ã€ŒæŸ¥è¯¢ã€è°ƒç”¨æ¬¡æ•°å’Œã€Œæ’å…¥ã€è°ƒç”¨æ¬¡æ•°ç›¸å½“ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¯”ä¼°ç®—å€¼å°çš„æ•°ï¼ˆå¾€ä¸‹è°ƒæ•´ä¸€ä¸ªæ•°é‡çº§ï¼‰ï¼Œæ›´è¯¦ç»†çš„ä¼°ç®—é€»è¾‘åœ¨ [å‰ç½®èŠå£«](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247488490&idx=1&sn=db2998cb0e5f08684ee1b6009b974089&chksm=fd9cb8f5caeb31e3f7f67dba981d8d01a24e26c93ead5491edb521c988adc0798d8acb6f9e9d&token=1006889101&lang=zh_CN#rd) è®²è¿‡ï¼Œä¸å†èµ˜è¿°ã€‚

ä½¿ç”¨æ•°ç»„å®ç°ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯ä¼˜åŒ–çš„åœ°æ–¹æ˜¯ä½¿ç”¨ `static` ä¿®é¥°æ‰€æœ‰ç”¨åˆ°çš„æ•°ç»„ï¼Œç„¶ååœ¨åˆå§‹åŒ– `Solution` çš„æ—¶å€™åšæ¸…ç†å·¥ä½œï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆé¿å…è·‘æ¯ä¸ªæ ·ä¾‹éƒ½åˆ›å»ºå¤§æ•°ç»„ã€‚

å®é™…æµ‹è¯•ä½¿ç”¨ `static` ä¸å¦æ‰§è¡Œæ—¶é—´ä¼šç›¸å·®è¶…è¿‡ä¸€åŠã€‚

ä»£ç ï¼ˆ$P1$ å¸¦ `static` ä¼˜åŒ–ï¼‰:
```Java
class WordDictionary {
    static int N = 250000;
    static int[][] tr = new int[N][26];
    static boolean[] isWord = new boolean[N];
    static int idx;
    public WordDictionary() {
        for (int i = 0; i < idx; i++) {
            Arrays.fill(tr[i], 0);
        }
        Arrays.fill(isWord, false);
        idx = 0;
    }
    public void addWord(String s) {
        int p = 0;
        for (int i = 0; i < s.length(); i++) {
            int u = s.charAt(i) - 'a';
            if (tr[p][u] == 0) tr[p][u] = ++idx;
            p = tr[p][u];
        }
        isWord[p] = true;
    }
    public boolean search(String s) {
        return dfs(s, 0, 0);
    }
    boolean dfs(String s, int trIdx, int sIdx) {
        int n = s.length();
        if (n == sIdx) return isWord[trIdx];
        char c = s.charAt(sIdx);
        if (c == '.') {
            for (int j = 0; j < 26; j++) {
                if (tr[trIdx][j] != 0 && dfs(s, tr[trIdx][j], sIdx + 1)) return true;
            }
            return false;
        } else {
            int u = c - 'a';
            if (tr[trIdx][u] == 0) return false;
            return dfs(s, tr[trIdx][u], sIdx + 1);
        }
    }
}
```

```Java
class WordDictionary {
    int N = 250000;
    int[][] tr = new int[N][26];
    boolean[] isWord = new boolean[N];
    int idx;
    public void addWord(String s) {
        int p = 0;
        for (int i = 0; i < s.length(); i++) {
            int u = s.charAt(i) - 'a';
            if (tr[p][u] == 0) tr[p][u] = ++idx;
            p = tr[p][u];
        }
        isWord[p] = true;
    }
    public boolean search(String s) {
        return dfs(s, 0, 0);
    }
    boolean dfs(String s, int trIdx, int sIdx) {
        int n = s.length();
        if (sIdx == n) return isWord[trIdx];
        char c = s.charAt(sIdx);
        if (c == '.') {
            for (int j = 0; j < 26; j++) {
                if (tr[trIdx][j] != 0 && dfs(s, tr[trIdx][j], sIdx + 1)) return true;
            }
            return false;
        } else {
            int u = c - 'a';
            if (tr[trIdx][u] == 0) return false;
            return dfs(s, tr[trIdx][u], sIdx + 1);
        }
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$L$ ä¸ºå­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ï¼Œ`addWord` æ“ä½œçš„å¤æ‚åº¦ä¸º $O(L)$ï¼›`search` æ“ä½œçš„å¤æ‚åº¦ä¸º $O(C * L)$ï¼Œå…¶ä¸­ $C$ ä¸ºå­—ç¬¦é›†å¤§å°ï¼Œå›ºå®šä¸º $26$
* ç©ºé—´å¤æ‚åº¦ï¼šé™æ€æ•°ç»„å¤§å°å›ºå®šï¼Œå¤æ‚åº¦ä¸º $O(1e7)$

---

### TrieNode

åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿä½¿ç”¨ $TrieNode$ çš„æ–¹å¼å®ç°ã€‚

å¥½å¤„æ˜¯ä¸éœ€è¦è¿›è¡Œæ•°ç»„å¤§å°ä¼°ç®—ï¼Œä½†æ˜¯ä¸å¯é¿å…éœ€è¦åœ¨ä¸€ä¸ªæ ·ä¾‹ä¸­æ‰§è¡Œå¤šæ¬¡ $new$ åŠ¨ä½œã€‚

ä»£ç ï¼š
```Java
class WordDictionary {
    class Node {
        Node[] tns = new Node[26];
        boolean isWord;
    }
    Node root = new Node();
    public void addWord(String s) {
        Node p = root;
        for (int i = 0; i < s.length(); i++) {
            int u = s.charAt(i) - 'a';
            if (p.tns[u] == null) p.tns[u] = new Node();
            p = p.tns[u];
        }
        p.isWord = true;
    }
    public boolean search(String s) {
        return dfs(s, root, 0);
    }
    boolean dfs(String s, Node p, int sIdx) {
        int n = s.length();
        if (n == sIdx) return p.isWord;
        char c = s.charAt(sIdx);
        if (c == '.') {
            for (int j = 0; j < 26; j++) {
                if (p.tns[j] != null && dfs(s, p.tns[j], sIdx + 1)) return true;
            }
            return false;
        } else {
            int u = c - 'a';
            if (p.tns[u] == null) return false;
            return dfs(s, p.tns[u], sIdx + 1);
        }
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š`addWord` æ“ä½œçš„å¤æ‚åº¦ä¸º $O(L)$ï¼›`search` æ“ä½œçš„å¤æ‚åº¦ä¸º $O(C * L)$ï¼Œå…¶ä¸­ $C$ ä¸ºå­—ç¬¦é›†å¤§å°ï¼Œå›ºå®šä¸º $26$
* ç©ºé—´å¤æ‚åº¦ï¼šä»¤ `n` ä¸ºæ’å…¥å­—ç¬¦ä¸²æ•°é‡ï¼Œ$L$ ä¸ºå­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ï¼Œå¤æ‚åº¦ä¸º $O(n * L)$

---

### æœ€å

è¿™æ˜¯æˆ‘ä»¬ã€Œåˆ·ç©¿ LeetCodeã€ç³»åˆ—æ–‡ç« çš„ç¬¬ `No.211` ç¯‡ï¼Œç³»åˆ—å¼€å§‹äº 2021/01/01ï¼Œæˆªæ­¢äºèµ·å§‹æ—¥ LeetCode ä¸Šå…±æœ‰ 1916 é“é¢˜ç›®ï¼Œéƒ¨åˆ†æ˜¯æœ‰é”é¢˜ï¼Œæˆ‘ä»¬å°†å…ˆæŠŠæ‰€æœ‰ä¸å¸¦é”çš„é¢˜ç›®åˆ·å®Œã€‚

åœ¨è¿™ä¸ªç³»åˆ—æ–‡ç« é‡Œé¢ï¼Œé™¤äº†è®²è§£è§£é¢˜æ€è·¯ä»¥å¤–ï¼Œè¿˜ä¼šå°½å¯èƒ½ç»™å‡ºæœ€ä¸ºç®€æ´çš„ä»£ç ã€‚å¦‚æœæ¶‰åŠé€šè§£è¿˜ä¼šç›¸åº”çš„ä»£ç æ¨¡æ¿ã€‚

ä¸ºäº†æ–¹ä¾¿å„ä½åŒå­¦èƒ½å¤Ÿç”µè„‘ä¸Šè¿›è¡Œè°ƒè¯•å’Œæäº¤ä»£ç ï¼Œæˆ‘å»ºç«‹äº†ç›¸å…³çš„ä»“åº“ï¼šhttps://github.com/SharingSource/LogicStack-LeetCode ã€‚

åœ¨ä»“åº“åœ°å€é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°ç³»åˆ—æ–‡ç« çš„é¢˜è§£é“¾æ¥ã€ç³»åˆ—æ–‡ç« çš„ç›¸åº”ä»£ç ã€LeetCode åŸé¢˜é“¾æ¥å’Œå…¶ä»–ä¼˜é€‰é¢˜è§£ã€‚

