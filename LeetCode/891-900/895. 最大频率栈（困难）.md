### é¢˜ç›®æè¿°

è¿™æ˜¯ LeetCode ä¸Šçš„ **[895. æœ€å¤§é¢‘ç‡æ ˆ](https://leetcode.cn/problems/maximum-frequency-stack/solution/by-ac_oier-tquk/)** ï¼Œéš¾åº¦ä¸º **å›°éš¾**ã€‚

Tag : ã€Œå“ˆå¸Œè¡¨ã€ã€ã€Œæ¨¡æ‹Ÿã€



è®¾è®¡ä¸€ä¸ªç±»ä¼¼å †æ ˆçš„æ•°æ®ç»“æ„ï¼Œå°†å…ƒç´ æ¨å…¥å †æ ˆï¼Œå¹¶ä»å †æ ˆä¸­å¼¹å‡ºå‡ºç°é¢‘ç‡æœ€é«˜çš„å…ƒç´ ã€‚

å®ç° `FreqStack`Â ç±»:
* `FreqStack()`Â æ„é€ ä¸€ä¸ªç©ºçš„å †æ ˆã€‚
* `void push(int val)`Â å°†ä¸€ä¸ªæ•´æ•°Â `val`Â å‹å…¥æ ˆé¡¶ã€‚
* `int pop()`Â åˆ é™¤å¹¶è¿”å›å †æ ˆä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å…ƒç´ ã€‚

å¦‚æœå‡ºç°é¢‘ç‡æœ€é«˜çš„å…ƒç´ ä¸åªä¸€ä¸ªï¼Œåˆ™ç§»é™¤å¹¶è¿”å›æœ€æ¥è¿‘æ ˆé¡¶çš„å…ƒç´ ã€‚

ç¤ºä¾‹ 1ï¼š
```
è¾“å…¥ï¼š
["FreqStack","push","push","push","push","push","push","pop","pop","pop","pop"],
[[],[5],[7],[5],[7],[4],[5],[],[],[],[]]

è¾“å‡ºï¼š[null,null,null,null,null,null,null,5,7,5,4]

è§£é‡Šï¼š
FreqStack = new FreqStack();
freqStack.push (5);//å †æ ˆä¸º [5]
freqStack.push (7);//å †æ ˆæ˜¯ [5,7]
freqStack.push (5);//å †æ ˆæ˜¯ [5,7,5]
freqStack.push (7);//å †æ ˆæ˜¯ [5,7,5,7]
freqStack.push (4);//å †æ ˆæ˜¯ [5,7,5,7,4]
freqStack.push (5);//å †æ ˆæ˜¯ [5,7,5,7,4,5]
freqStack.pop ();//è¿”å› 5 ï¼Œå› ä¸º 5 å‡ºç°é¢‘ç‡æœ€é«˜ã€‚å †æ ˆå˜æˆ [5,7,5,7,4]ã€‚
freqStack.pop ();//è¿”å› 7 ï¼Œå› ä¸º 5 å’Œ 7 å‡ºç°é¢‘ç‡æœ€é«˜ï¼Œä½†7æœ€æ¥è¿‘é¡¶éƒ¨ã€‚å †æ ˆå˜æˆ [5,7,5,4]ã€‚
freqStack.pop ();//è¿”å› 5 ï¼Œå› ä¸º 5 å‡ºç°é¢‘ç‡æœ€é«˜ã€‚å †æ ˆå˜æˆ [5,7,4]ã€‚
freqStack.pop ();//è¿”å› 4 ï¼Œå› ä¸º 4, 5 å’Œ 7 å‡ºç°é¢‘ç‡æœ€é«˜ï¼Œä½† 4 æ˜¯æœ€æ¥è¿‘é¡¶éƒ¨çš„ã€‚å †æ ˆå˜æˆ [5,7]ã€‚
```

æç¤ºï¼š
* $0 <= val <= 10^9$
* `push`Â å’Œ `pop`Â çš„æ“ä½œæ•°ä¸å¤§äº $2 \times 10^4$
* è¾“å…¥ä¿è¯åœ¨è°ƒç”¨Â `pop`Â ä¹‹å‰å †æ ˆä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ 

---

### å“ˆå¸Œè¡¨

è¿™æ˜¯ä¸€é“å¾ˆçº¯çš„å“ˆå¸Œè¡¨é¢˜å„¿ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å®¹æ˜“æƒ³åˆ°å»ºç«‹ **ç¬¬ä¸€ä¸ªå“ˆå¸Œè¡¨ `cnts` ç”¨äºè®°å½•æŸä¸ªæ•°å€¼çš„å‡ºç°æ¬¡æ•°ï¼Œ`cnts[val] = c` å«ä¹‰ä¸ºæ•°å€¼ `val` å½“å‰åœ¨æ ˆä¸­çš„å‡ºç°æ¬¡æ•°ä¸º `c`ã€‚æˆ‘ä»¬ç§°è¯¥å“ˆå¸Œè¡¨ä¸ºã€Œè®¡æ•°å“ˆå¸Œè¡¨ã€**ã€‚

å†ç»“åˆæ¯æ¬¡ `pop` éœ€è¦è¿”å›ã€Œé¢‘ç‡æœ€å¤§çš„å…ƒç´ ï¼Œè‹¥æœ‰å¤šä¸ªåˆ™è¿”å›æœ€è€ƒè™‘æ ˆé¡¶çš„ä¸€ä¸ªã€çš„è¦æ±‚ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ **å»ºç«‹ç¬¬äºŒä¸ªå“ˆå¸Œ `map`ï¼Œè¯¥å“ˆå¸Œè¡¨ä»¥ã€Œå‡ºç°æ¬¡æ•° `c`ã€ä¸ºé”®ï¼Œä»¥ã€Œå‡ºç°æ¬¡æ•°å‡ä¸º `c` çš„å…ƒç´ åºåˆ—ã€ä¸ºå€¼ï¼Œ`map[c] = A = [...]` å«ä¹‰ä¸ºå‡ºç°æ¬¡æ•°ä¸º `c` çš„åºåˆ—ä¸º `A`ï¼Œå¹¶ä¸”åºåˆ— `A` ä¸­çš„ç»“å°¾å…ƒç´ ä¸ºå‡ºç°æ¬¡æ•°ä¸º `c` çš„æ‰€æœ‰å…ƒç´ ä¸­æœ€é è¿‘æ ˆé¡¶çš„å…ƒç´ ã€‚æˆ‘ä»¬ç§°è¯¥å“ˆå¸Œè¡¨ä¸ºã€Œåˆ†æ¡¶å“ˆå¸Œè¡¨ã€**ã€‚

æœ€åå†é¢å¤–ä½¿ç”¨ä¸€ä¸ªå˜é‡ `max` è®°å½•å½“å‰æœ€å¤§å‡ºç°é¢‘æ•°ï¼Œä¸éš¾å‘ç°ï¼Œ`max` å¿…ç„¶æ˜¯ä»¥æ­¥é•¿ $\pm 1$ è¿›è¡Œå˜åŒ–ï¼ˆå½“å‡ºç°æ¬¡æ•°ä¸º `max` çš„å…ƒç´ è¢« `pop` æ‰äº†ä¸€ä¸ªåï¼Œå¿…ç„¶å‰©ä¸‹ `max - 1` ä¸ªï¼‰ï¼Œå› æ­¤å½“æˆ‘ä»¬åœ¨æŸæ¬¡ `pop` æ“ä½œåå‘ç°å‡ºç°æ¬¡æ•°ä¸º `max` çš„é›†åˆä¸ºç©ºæ—¶ï¼Œå¯¹ `max` è¿›è¡Œè‡ªå‡æ“ä½œå³å¯ã€‚

å°†é¢˜ç›®ç»™çš„æ ·ä¾‹ä½œä¸º ğŸŒ° ï¼Œå¤§å®¶å¯ä»¥çœ‹çœ‹ `cnts`ã€`map` å’Œ `max` ä¸‰è€…å¦‚ä½•å˜åŒ–ï¼Œä»¥åŠ `pop` çš„æ›´æ–°é€»è¾‘ï¼š

![](https://pic.leetcode.cn/1669771856-XhpLSw-image.png)

Java ä»£ç ï¼š
```Java
class FreqStack {
    Map<Integer, List<Integer>> map = new HashMap<>();
    Map<Integer, Integer> cnts = new HashMap<>();
    int max;
    public void push(int val) {
        cnts.put(val, cnts.getOrDefault(val, 0) + 1);
        int c = cnts.get(val);
        List<Integer> list = map.getOrDefault(c, new ArrayList<>());
        list.add(val);
        map.put(c, list);
        max = Math.max(max, c);
    }
    public int pop() {
        List<Integer> list = map.get(max);
        int ans = list.remove(list.size() - 1);
        cnts.put(ans, cnts.get(ans) - 1);
        if (list.size() == 0) max--;
        return ans;
    }
}
```
C++ ä»£ç ï¼š
```C++
class FreqStack {
public:
    unordered_map<int, int> freq;
    unordered_map<int, vector<int>> m;
    int maxv = 0;
    
    void push(int val) {
        maxv = max(maxv, ++freq[val]);
        m[freq[val]].push_back(val);
    }
    
    int pop() {
        int x = m[maxv].back(); 
        m[maxv].pop_back();
        if (m[freq[x]--].empty()) maxv--;
        return x;
    }
};
```
Python ä»£ç ï¼š
```Python
class FreqStack:
    def __init__(self):
        self.cnts = defaultdict(int)
        self.map = defaultdict(list)
        self.mv = 0

    def push(self, val: int) -> None:
        self.cnts[val] += 1
        c = self.cnts[val]
        self.map[c].append(val)
        self.mv = max(self.mv, c)

    def pop(self) -> int:
        ans = self.map[self.mv].pop()
        self.cnts[ans] -= 1
        self.mv -= 0 if self.map[self.mv] else 1
        return ans
```
TypeScript ä»£ç ï¼š
```TypeScript
class FreqStack {
    map: Map<number, Array<number>> = new Map<number, Array<number>>()
    cnst: Map<number, number> = new Map<number, number>()
    max: number = 0
    push(val: number): void {
        if (!this.cnst.has(val)) this.cnst.set(val, 0)
        this.cnst.set(val, this.cnst.get(val) + 1)
        const c = this.cnst.get(val)
        if (!this.map.has(c)) this.map.set(c, new Array<number>())
        this.map.get(c).push(val)
        this.max = Math.max(this.max, c)
    }
    pop(): number {
        const ans = this.map.get(this.max).pop()
        if (this.map.get(this.max).length == 0) this.max--
        this.cnst.set(ans, this.cnst.get(ans) - 1)
        return ans
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šæ‰€æœ‰æ“ä½œå‡ä¸º $O(1)$
* ç©ºé—´å¤æ‚åº¦ï¼šæ‰€æœ‰å…¥æ ˆçš„èŠ‚ç‚¹æœ€å¤šä¼šè¢«å­˜å‚¨ä¸¤æ¬¡ï¼Œä¸€æ¬¡åœ¨è®¡æ•°å“ˆå¸Œè¡¨ä¸­ï¼Œä¸€æ¬¡åœ¨åˆ†æ¡¶å“ˆå¸Œè¡¨ä¸­ï¼Œå¤æ‚åº¦ä¸º $O(n)$

---

### æœ€å

è¿™æ˜¯æˆ‘ä»¬ã€Œåˆ·ç©¿ LeetCodeã€ç³»åˆ—æ–‡ç« çš„ç¬¬ `No.895` ç¯‡ï¼Œç³»åˆ—å¼€å§‹äº 2021/01/01ï¼Œæˆªæ­¢äºèµ·å§‹æ—¥ LeetCode ä¸Šå…±æœ‰ 1916 é“é¢˜ç›®ï¼Œéƒ¨åˆ†æ˜¯æœ‰é”é¢˜ï¼Œæˆ‘ä»¬å°†å…ˆæŠŠæ‰€æœ‰ä¸å¸¦é”çš„é¢˜ç›®åˆ·å®Œã€‚

åœ¨è¿™ä¸ªç³»åˆ—æ–‡ç« é‡Œé¢ï¼Œé™¤äº†è®²è§£è§£é¢˜æ€è·¯ä»¥å¤–ï¼Œè¿˜ä¼šå°½å¯èƒ½ç»™å‡ºæœ€ä¸ºç®€æ´çš„ä»£ç ã€‚å¦‚æœæ¶‰åŠé€šè§£è¿˜ä¼šç›¸åº”çš„ä»£ç æ¨¡æ¿ã€‚

ä¸ºäº†æ–¹ä¾¿å„ä½åŒå­¦èƒ½å¤Ÿç”µè„‘ä¸Šè¿›è¡Œè°ƒè¯•å’Œæäº¤ä»£ç ï¼Œæˆ‘å»ºç«‹äº†ç›¸å…³çš„ä»“åº“ï¼šhttps://github.com/SharingSource/LogicStack-LeetCode ã€‚

åœ¨ä»“åº“åœ°å€é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°ç³»åˆ—æ–‡ç« çš„é¢˜è§£é“¾æ¥ã€ç³»åˆ—æ–‡ç« çš„ç›¸åº”ä»£ç ã€LeetCode åŸé¢˜é“¾æ¥å’Œå…¶ä»–ä¼˜é€‰é¢˜è§£ã€‚

