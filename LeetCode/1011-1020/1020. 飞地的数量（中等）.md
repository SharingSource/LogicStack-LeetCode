### é¢˜ç›®æè¿°

è¿™æ˜¯ LeetCode ä¸Šçš„ **[1020. é£åœ°çš„æ•°é‡](https://assets.leetcode.com/uploads/2021/02/18/enclaves1.jpg)** ï¼Œéš¾åº¦ä¸º **ä¸­ç­‰**ã€‚

Tag : ã€ŒDFSã€ã€ã€Œå¹¶æŸ¥é›†ã€



ç»™ä½ ä¸€ä¸ªå¤§å°ä¸º $m x n$ çš„äºŒè¿›åˆ¶çŸ©é˜µ $grid$ ï¼Œå…¶ä¸­ $0$ è¡¨ç¤ºä¸€ä¸ªæµ·æ´‹å•å…ƒæ ¼ã€$1$ è¡¨ç¤ºä¸€ä¸ªé™†åœ°å•å…ƒæ ¼ã€‚

ä¸€æ¬¡ ç§»åŠ¨ æ˜¯æŒ‡ä»ä¸€ä¸ªé™†åœ°å•å…ƒæ ¼èµ°åˆ°å¦ä¸€ä¸ªç›¸é‚»ï¼ˆä¸Šã€ä¸‹ã€å·¦ã€å³ï¼‰çš„é™†åœ°å•å…ƒæ ¼æˆ–è·¨è¿‡ $grid$ çš„è¾¹ç•Œã€‚

è¿”å›ç½‘æ ¼ä¸­ æ— æ³• åœ¨ä»»æ„æ¬¡æ•°çš„ç§»åŠ¨ä¸­ç¦»å¼€ç½‘æ ¼è¾¹ç•Œçš„é™†åœ°å•å…ƒæ ¼çš„æ•°é‡ã€‚

ç¤ºä¾‹ 1ï¼š
![](https://assets.leetcode.com/uploads/2021/02/18/enclaves1.jpg)
```
è¾“å…¥ï¼šgrid = [[0,0,0,0],[1,0,1,0],[0,1,1,0],[0,0,0,0]]

è¾“å‡ºï¼š3

è§£é‡Šï¼šæœ‰ä¸‰ä¸ª 1 è¢« 0 åŒ…å›´ã€‚ä¸€ä¸ª 1 æ²¡æœ‰è¢«åŒ…å›´ï¼Œå› ä¸ºå®ƒåœ¨è¾¹ç•Œä¸Šã€‚
```
ç¤ºä¾‹ 2ï¼š
![](https://assets.leetcode.com/uploads/2021/02/18/enclaves2.jpg)
```
è¾“å…¥ï¼šgrid = [[0,1,1,0],[0,0,1,0],[0,0,1,0],[0,0,0,0]]

è¾“å‡ºï¼š0

è§£é‡Šï¼šæ‰€æœ‰ 1 éƒ½åœ¨è¾¹ç•Œä¸Šæˆ–å¯ä»¥åˆ°è¾¾è¾¹ç•Œã€‚
```

æç¤ºï¼š
* $m == grid.length$
* $n == grid[i].length$
* $1 <= m, n <= 500$
* $grid[i][j]$ çš„å€¼ä¸º $0$ æˆ– $1$

---

### å¹¶æŸ¥é›† + DFS

æ ¹æ®é¢˜ç›®å®šä¹‰ï¼Œæˆ‘ä»¬çŸ¥é“éœ€è¦ç»Ÿè®¡æ‰€æœ‰ä¸å’Œã€Œè¾¹ç¼˜é™†åœ°ã€ç›¸è¿é€šçš„ã€Œæ™®é€šé™†åœ°ã€æ•°é‡ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ã€Œå¹¶æŸ¥é›†ã€æ¥ç»´æŠ¤è¿é€šå—ï¼Œä½¿ç”¨ `DFS` å¯¹æ‰€æœ‰ã€Œè¾¹ç¼˜é™†åœ°è¿é€šå—ã€è¿›è¡Œæ ‡è®°ï¼ˆè®¾å®šç¼–å·ä¸º $0$ çš„è¶…çº§æºç‚¹ï¼Œå¯¹äºæ‰€æœ‰çš„ã€Œè¾¹ç¼˜é™†åœ°è¿é€šå—ã€ï¼Œå°†å…¶ä¸è¶…çº§æºç‚¹è”é€šï¼‰ã€‚

å…·ä½“çš„ï¼Œæˆ‘ä»¬æŒ‰ç…§å¦‚ä¸‹æµç¨‹è¿›è¡Œå¤„ç†ï¼š

* åˆå§‹åŒ–å¹¶æŸ¥é›†ï¼šèµ·å§‹è®©æ¯ä¸ªå•å…ƒæ ¼ç‹¬ç«‹ä½œä¸ºä¸€ä¸ªè¿é€šå—ï¼›
* ä½¿ç”¨ `DFS`  æ ‡è®°æ‰€æœ‰ã€Œè¾¹ç¼˜é™†åœ°è¿é€šå—ã€ï¼šä»ä½äºè¾¹ç¼˜çš„ã€Œè¾¹ç¼˜é™†åœ°ã€è¿›è¡Œå‡ºå‘ï¼Œå°†å…¶æ‰€åœ¨è¿é€šå—ä¸è¶…çº§æºç‚¹ $0$ è¿›è¡Œè”é€šæ ‡è®°ï¼ˆåŒæ—¶ä¸ºäº†ç¡®ä¿å¤æ‚åº¦ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œ `DFS` å‰éœ€è¦å…ˆæ£€æŸ¥å½“å‰é™†åœ°ä¸è¶…çº§æºç‚¹çš„è”é€šå…³ç³»ï¼Œå¦‚æœå·²è”é€šï¼Œè¯´æ˜å½“å‰é™†åœ°æ££å±äºä¹‹å‰çš„æŸä¸ªè¿é€šå—ï¼Œå·²è¢«æ•´ä½“æ ‡è®°è¿‡ï¼Œè¿›è¡Œè·³è¿‡å³å¯ï¼‰ï¼›
* ç»Ÿè®¡ç­”æ¡ˆï¼šéå†æ•´ä¸ªæ£‹ç›˜ï¼Œç»Ÿè®¡æ‰€æœ‰ä¸ä¸è¶…çº§æºç‚¹ $0$ è”é€šçš„é™†åœ°æ•°é‡ã€‚

> ä¸€äº›ç»†èŠ‚ï¼šç”±äºæˆ‘ä»¬äººä¸ºè§„å®šäº†è¶…çº§æºç‚¹ç¼–å·ä¸º $0$ï¼ŒåŒæ—¶æ£‹ç›˜ä¸‹æ ‡ä» $0$ å¼€å§‹ï¼Œå› æ­¤å¯¹æŸä¸ªç‚¹ $(x, y)$ çš„ç¼–å·ï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªåç§»é‡ï¼Œä¾‹å¦‚ $idx = x * n + y + 1$ã€‚

ä»£ç ï¼š
```Java
class Solution {
    int N = 550;
    int[] p = new int[N * N];
    int m, n;
    int[][] g;
    int find(int x) {
        if (p[x] != x) p[x] = find(p[x]);
        return p[x];
    }
    boolean query(int a, int b) {
        return find(a) == find(b);
    }
    void union(int a, int b) {
        p[find(a)] = find(b);
    }
    public int numEnclaves(int[][] grid) {
        g = grid;
        m = g.length; n = g[0].length;
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                p[getIdx(i, j)] = getIdx(i, j);
            }
        }
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (i == 0 || j == 0 || i == m - 1 || j == n - 1) {
                    if (g[i][j] != 1 || query(getIdx(i, j), 0)) continue;
                    dfs(i, j);
                }
            }
        }
        int ans = 0;
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (g[i][j] == 1 && !query(getIdx(i, j), 0)) ans++;
            }
        }
        return ans;
    }
    int[][] dirs = new int[][]{{1,0},{-1,0},{0,1},{0,-1}};
    void dfs(int x, int y) {
        union(getIdx(x, y), 0);
        for (int[] d : dirs) {
            int nx = x + d[0], ny = y + d[1];
            if (nx < 0 || nx >= m || ny < 0 || ny >= n) continue;
            if (g[nx][ny] != 1 || query(getIdx(nx, ny), 0)) continue;
            dfs(nx, ny);
        }
    }
    int getIdx(int x, int y) {
        return x * n + y + 1;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼šåˆå§‹åŒ–å¹¶æŸ¥é›†å¤æ‚åº¦ä¸º $O(m * n)$ï¼›ä½¿ç”¨ `DFS` å¯¹è¾¹ç¼˜é™†åœ°è¿é€šå—è¿›è¡Œæ ‡è®°å¤æ‚åº¦ä¸º $O(m * n)$ï¼›ç»Ÿè®¡ç­”æ¡ˆå¤æ‚åº¦ä¸º $O(m * n)$ã€‚æ•´ä½“å¤æ‚åº¦ä¸º $O(m * n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(m * n)$

---

### å¤šæº BFS

ä¹Ÿå¯ä»¥ä½¿ç”¨ã€Œå¤šæº `BFS`ã€è¿›è¡Œæ±‚è§£ã€‚

å°†æ‰€æœ‰ã€Œè¾¹ç¼˜é™†åœ°ã€çœ‹åšä¸è¶…çº§æºç‚¹ç›¸è¿ï¼Œèµ·å§‹å°†æ‰€æœ‰ã€Œè¾¹ç¼˜é™†åœ°ã€è¿›è¡Œå…¥é˜Ÿï¼ˆç­‰ä»·äºåªå°†è¶…çº§æºç‚¹å…¥é˜Ÿï¼Œç„¶åå–å‡ºè¶…çº§æºç‚¹å¹¶è¿›è¡Œæ‹“å±•ï¼‰ã€‚

ç„¶åæ˜¯å¸¸è§„çš„ `BFS` è¿‡ç¨‹ï¼Œæ‰€æœ‰èƒ½å¤Ÿå‡ºé˜Ÿ/å…¥é˜Ÿçš„é™†åœ°æ ¼å­ï¼Œéƒ½ä»£è¡¨ä¸ã€Œè¾¹ç¼˜é™†åœ°ã€è”é€šï¼Œéƒ½ä¸å±äºã€Œé£åœ°ã€ï¼Œå¯¹å…¶è¿›è¡Œæ ‡è®°ã€‚

æœ€åéå†æ•´ä¸ªæ£‹ç›˜ï¼Œç»Ÿè®¡æ‰€æœ‰æœªè¢«æ ‡è®°çš„ã€Œé™†åœ°ã€æ ¼å­æ•°é‡å³æ˜¯ç­”æ¡ˆã€‚

ä¸ç†Ÿæ‚‰ã€Œå¤šæº `BFS`ã€çš„åŒå­¦å¯ä»¥çœ‹å‰ç½® ğŸ§€ ï¼š[å¤šæº BFS å…¥é—¨](https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247487179&idx=1&sn=e30a662c03fba3861254dbcf3fb9d6f2&chksm=fd9ca5d4caeb2cc205804fd17a2ce86b25d0408adc3417e73154f59d37e7cb17e02374f5122c&token=1222269277&lang=zh_CN#rd)ã€‚

ä»£ç ï¼š
```Java
class Solution {
    public int numEnclaves(int[][] g) {
        int m = g.length, n = g[0].length;
        boolean[][] vis = new boolean[m][n];
        Deque<int[]> d = new ArrayDeque<>();
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (i == 0 || j == 0 || i == m - 1 || j == n - 1) {
                    if (g[i][j] == 0) continue;
                    vis[i][j] = true;
                    d.addLast(new int[]{i, j});
                }
            }
        }
        int[][] dirs = new int[][]{{1,0},{-1,0},{0,1},{0,-1}};
        while (!d.isEmpty()) {
            int[] poll = d.pollFirst();
            int x = poll[0], y = poll[1];
            for (int[] di : dirs) {
                int nx = x + di[0], ny = y + di[1];
                if (nx < 0 || nx >= m || ny < 0 || ny >= n) continue;
                if (g[nx][ny] != 1) continue;
                if (vis[nx][ny]) continue;
                vis[nx][ny] = true;
                d.addLast(new int[]{nx, ny});
            }
        }
        int ans = 0;
        for (int i = 0; i < m; i++) {
            for (int j = 0; j < n; j++) {
                if (g[i][j] == 1 && !vis[i][j]) ans++;
            }
        }
        return ans;
    }
}
```
* æ—¶é—´å¤æ‚åº¦ï¼š$O(m * n)$
* ç©ºé—´å¤æ‚åº¦ï¼š$O(m * n)$

---

### æœ€å

è¿™æ˜¯æˆ‘ä»¬ã€Œåˆ·ç©¿ LeetCodeã€ç³»åˆ—æ–‡ç« çš„ç¬¬ `No.1011` ç¯‡ï¼Œç³»åˆ—å¼€å§‹äº 2021/01/01ï¼Œæˆªæ­¢äºèµ·å§‹æ—¥ LeetCode ä¸Šå…±æœ‰ 1916 é“é¢˜ç›®ï¼Œéƒ¨åˆ†æ˜¯æœ‰é”é¢˜ï¼Œæˆ‘ä»¬å°†å…ˆæŠŠæ‰€æœ‰ä¸å¸¦é”çš„é¢˜ç›®åˆ·å®Œã€‚

åœ¨è¿™ä¸ªç³»åˆ—æ–‡ç« é‡Œé¢ï¼Œé™¤äº†è®²è§£è§£é¢˜æ€è·¯ä»¥å¤–ï¼Œè¿˜ä¼šå°½å¯èƒ½ç»™å‡ºæœ€ä¸ºç®€æ´çš„ä»£ç ã€‚å¦‚æœæ¶‰åŠé€šè§£è¿˜ä¼šç›¸åº”çš„ä»£ç æ¨¡æ¿ã€‚

ä¸ºäº†æ–¹ä¾¿å„ä½åŒå­¦èƒ½å¤Ÿç”µè„‘ä¸Šè¿›è¡Œè°ƒè¯•å’Œæäº¤ä»£ç ï¼Œæˆ‘å»ºç«‹äº†ç›¸å…³çš„ä»“åº“ï¼šhttps://github.com/SharingSource/LogicStack-LeetCode ã€‚

åœ¨ä»“åº“åœ°å€é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°ç³»åˆ—æ–‡ç« çš„é¢˜è§£é“¾æ¥ã€ç³»åˆ—æ–‡ç« çš„ç›¸åº”ä»£ç ã€LeetCode åŸé¢˜é“¾æ¥å’Œå…¶ä»–ä¼˜é€‰é¢˜è§£ã€‚

